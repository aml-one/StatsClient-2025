<Window x:Class="StatsClient.MVVM.View.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:viewmodel="clr-namespace:StatsClient.MVVM.ViewModel"
        xmlns:core="clr-namespace:StatsClient.MVVM.Core"
        xmlns:converter="clr-namespace:StatsClient.MVVM.Converters"
        xmlns:localView="clr-namespace:StatsClient.MVVM.View"
        xmlns:i="http://schemas.microsoft.com/xaml/behaviors"
        xmlns:sf="clr-namespace:Syncfusion.Windows.PdfViewer;assembly=Syncfusion.PdfViewer.WPF"
        mc:Ignorable="d"
        ResizeMode="CanResizeWithGrip"
        WindowStyle="None"
        WindowState="Normal"
        AllowsTransparency="True"
        Foreground="Beige"
        Closing="Window_Closing"
        LocationChanged="Window_LocationChanged"
        SizeChanged="Window_SizeChanged"
        Title="Stats Client 2025"
        Height="550"
        d:Height="800"
        Width="1120"
        MinHeight="550"
        MinWidth="1120"
        Icon="/Images/stats_2025_Q512.png">



    <Window.DataContext>
        <viewmodel:MainViewModel />
    </Window.DataContext>

    <WindowChrome.WindowChrome>
        <WindowChrome ResizeBorderThickness="5,5,5,5"
                      CaptionHeight="0" />
    </WindowChrome.WindowChrome>

    <Window.Resources>
        <ResourceDictionary>
            <ResourceDictionary.MergedDictionaries>
                <ResourceDictionary Source="/Themes/ScrollBar.xaml" />
                <ResourceDictionary Source="/Themes/TabControlStyles.xaml" />
                <ResourceDictionary Source="/Themes/CircleCheckBox.xaml" />
                <ResourceDictionary Source="/Themes/LvItemModern.xaml" />
                <ResourceDictionary Source="/Themes/ControlStyles.xaml" />
                <ResourceDictionary Source="/Themes/SearchBoxTitleBar.xaml" />
            </ResourceDictionary.MergedDictionaries>

            <BeginStoryboard x:Key="ProgramIconShrinkAnimation">
                <Storyboard>
                    <DoubleAnimation Storyboard.TargetName="programIcon"
                                     Storyboard.TargetProperty="(Width)"
                                     Duration="0:0:1.5"
                                     From="25"
                                     To="5" />
                </Storyboard>
            </BeginStoryboard>

            <BeginStoryboard x:Key="ProgramIconGrowAnimation">
                <Storyboard>
                    <DoubleAnimation Storyboard.TargetName="programIcon"
                                     Storyboard.TargetProperty="(Width)"
                                     Duration="0:0:1"
                                     From="5"
                                     To="25" />
                </Storyboard>
            </BeginStoryboard>

            <converter:InverseBoolConverter x:Key="InverseBoolConverter" />
            <converter:BoolToVisibilityConverter x:Key="BoolToVisibilityConverter" />
            <converter:RemoveIDTagFromFrontConverter x:Key="RemoveIDTagFromFrontConverter" />

            <converter:EmptyToHiddenConverter x:Key="EmptyToHiddenConverter" />
            <converter:EmptyToVisibleConverter x:Key="EmptyToVisibleConverter" />
            <converter:EqualToHiddenConverter x:Key="EqualToHiddenConverter" />
            <converter:StringToImageConverter x:Key="StringToImageConverter" />
            <converter:ZeroToVisibleConverter x:Key="ZeroToVisibleConverter" />
            <converter:ZeroToCollapsedConverter x:Key="ZeroToCollapsedConverter" />
            <converter:ZeroToCollapsedVisibilityConverter x:Key="ZeroToCollapsedVisibilityConverter" />
            <converter:BoolToOpacityConverter x:Key="BoolToOpacityConverter" />
            <converter:ZeroToFalseConverter x:Key="ZeroToFalseConverter" />
            <converter:MyRecentToFalseConverter x:Key="MyRecentToFalseConverter" />


            <Style x:Key="HiddenHeaderStyle"
                   TargetType="{x:Type GridViewColumnHeader}">
                <Setter Property="Visibility"
                        Value="Collapsed" />
            </Style>


            <ControlTemplate x:Key="CustomHeader"
                             TargetType="GridViewColumnHeader">
                <Border BorderBrush="#888"
                        BorderThickness="0,0,0,1">
                    
                <Grid Background="#E8E8E8"
                      Height="20"
                      Margin="-2,0,0,0">
                    <TextBlock Background="#E8E8E8"
                               Foreground="Black"
                               FontWeight="SemiBold"
                               Text="{TemplateBinding Tag}"
                               VerticalAlignment="Center" />
                    <Thumb x:Name="PART_HeaderGripper"
                           HorizontalAlignment="Right"
                           
                           Margin="0"
                           Width="1" />
                </Grid>
                </Border>
            </ControlTemplate>

            <Style TargetType="{x:Type GridViewColumnHeader}">
                <Setter Property="Foreground"
                        Value="Black" />
                <Setter Property="Background"
                        Value="#E8E8E8" />
                <Setter Property="FontWeight"
                        Value="Normal" />
                <Style.Triggers>
                    <Trigger Property="IsMouseOver"
                             Value="True">
                        <Setter Property="Foreground"
                                Value="Black" />
                        <Setter Property="Background"
                                Value="#DDD" />
                    </Trigger>
                </Style.Triggers>
            </Style>

            <ControlTemplate x:Key="CustomHeaderPendingDigi"
                             TargetType="GridViewColumnHeader">
                <Grid Background="#888"
                      Height="20"
                      Margin="-2,0,0,0">
                    <TextBlock Background="#888"
                               Foreground="Beige"
                               Text="{TemplateBinding Tag}"
                               VerticalAlignment="Center" />
                    <Thumb x:Name="PART_HeaderGripper"
                           HorizontalAlignment="Right"
                           Margin="0"
                           Width="1" />
                </Grid>
            </ControlTemplate>

        </ResourceDictionary>
    </Window.Resources>

    <Window.Background>
        <SolidColorBrush Opacity="{Binding CbSettingGlassyEffect, UpdateSourceTrigger=PropertyChanged, Converter={StaticResource BoolToOpacityConverter}}" />
    </Window.Background>

    <Border CornerRadius="8,8,4,8"
            BorderThickness="0.5"
            BorderBrush="Black"
            Background="{Binding WindowBackground}"
            d:Background="#56595F"
            Opacity="{Binding CbSettingGlassyEffect, UpdateSourceTrigger=PropertyChanged, Converter={StaticResource BoolToOpacityConverter}}"
            ClipToBounds="True">
        <Grid Margin="4,0,4,0">
            <Grid.RowDefinitions>
                <RowDefinition Height="0" />
                <RowDefinition />
                <RowDefinition Height="{Binding BottomBarSize}"
                               d:Height="135" />
            </Grid.RowDefinitions>
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="35" />
                <ColumnDefinition />
            </Grid.ColumnDefinitions>



            <!-- TITLEBAR-->



            <DockPanel LastChildFill="True"
                       Grid.Column="0"
                       Grid.RowSpan="3"
                       Margin="-4,0,-4,0">




                <Button x:Name="btnMaximize"
                        Content="▣"
                        Tag="⧉"
                        Width="40"
                        Height="35"
                        FontSize="14"
                        Padding="0,5,0,0"
                        DockPanel.Dock="Top"
                        Margin="-5,0,0,0"
                        Panel.ZIndex="50"
                        Foreground="Beige"
                        Background="Transparent"
                        BorderThickness="0"
                        IsTabStop="False"
                        Click="BtnMaximize_Click">
                    <Button.Style>
                        <Style TargetType="{x:Type Button}">
                            <Setter Property="Background"
                                    Value="Transparent" />
                            <Setter Property="Template">
                                <Setter.Value>
                                    <ControlTemplate TargetType="{x:Type Button}">
                                        <Border x:Name="Border"
                                                Background="{TemplateBinding Background}"
                                                CornerRadius="10,0,0,0">
                                            <ContentPresenter HorizontalAlignment="Center"
                                                              VerticalAlignment="Center" />
                                        </Border>
                                        <ControlTemplate.Triggers>
                                            <Trigger Property="IsMouseOver"
                                                     Value="True">
                                                <Setter Property="Background"
                                                        Value="#76797F"
                                                        TargetName="Border" />
                                            </Trigger>
                                        </ControlTemplate.Triggers>
                                    </ControlTemplate>
                                </Setter.Value>
                            </Setter>
                        </Style>
                    </Button.Style>
                </Button>
                <Button x:Name="btnMinimize"
                        Content="▪"
                        DockPanel.Dock="Top"
                        Width="40"
                        Height="35"
                        FontSize="16"
                        Panel.ZIndex="50"
                        Margin="-5,0,0,0"
                        Foreground="Beige"
                        Background="Transparent"
                        BorderThickness="0"
                        IsTabStop="False"
                        Click="BtnMinimize_Click">
                    <Button.Style>
                        <Style TargetType="{x:Type Button}">
                            <Setter Property="Background"
                                    Value="Transparent" />
                            <Setter Property="Template">
                                <Setter.Value>
                                    <ControlTemplate TargetType="{x:Type Button}">
                                        <Border x:Name="Border"
                                                Background="{TemplateBinding Background}">
                                            <ContentPresenter HorizontalAlignment="Center"
                                                              VerticalAlignment="Center" />
                                        </Border>
                                        <ControlTemplate.Triggers>
                                            <Trigger Property="IsMouseOver"
                                                     Value="True">
                                                <Setter Property="Background"
                                                        Value="#76797F"
                                                        TargetName="Border" />
                                            </Trigger>
                                        </ControlTemplate.Triggers>
                                    </ControlTemplate>
                                </Setter.Value>
                            </Setter>
                        </Style>
                    </Button.Style>
                </Button>

                <Button x:Name="btnCloseApplication"
                        Content="╳"
                        DockPanel.Dock="Top"
                        Width="40"
                        Height="35"
                        FontSize="12"
                        Panel.ZIndex="50"
                        Margin="-5,0,0,0"
                        Foreground="Beige"
                        Background="Transparent"
                        BorderThickness="0"
                        IsTabStop="False"
                        Click="BtnCloseApplication_Click">
                    <Button.Style>
                        <Style TargetType="{x:Type Button}">
                            <Setter Property="Background"
                                    Value="Transparent" />
                            <Setter Property="Template">
                                <Setter.Value>
                                    <ControlTemplate TargetType="{x:Type Button}">
                                        <Border x:Name="Border"
                                                Background="{TemplateBinding Background}">
                                            <ContentPresenter HorizontalAlignment="Center"
                                                              VerticalAlignment="Center" />
                                        </Border>
                                        <ControlTemplate.Triggers>
                                            <Trigger Property="IsMouseOver"
                                                     Value="True">
                                                <Setter Property="Background"
                                                        Value="#de766b"
                                                        TargetName="Border" />
                                            </Trigger>
                                        </ControlTemplate.Triggers>
                                    </ControlTemplate>
                                </Setter.Value>
                            </Setter>
                        </Style>
                    </Button.Style>
                </Button>

                


                <Grid Height="39"
                      DockPanel.Dock="Bottom">
                    <Image Source="/Images/stats_2025_Q512.png"
                           Height="25"
                           x:Name="programIcon"
                           Panel.ZIndex="200"
                           DockPanel.Dock="Bottom"
                           Margin="1,5,5,9">
                        <i:Interaction.Triggers>
                            <i:EventTrigger EventName="MouseDown">
                                <i:InvokeCommandAction Command="{Binding LookForUpdateCommand}" />
                            </i:EventTrigger>
                        </i:Interaction.Triggers>
                    </Image>
                </Grid>


                <Border x:Name="TitleBar"
                        Background="Transparent"
                        HorizontalAlignment="Stretch"
                        CornerRadius="0,0,0,0"
                        DockPanel.Dock="Top"
                        PreviewMouseDown="TitleBar_PreviewMouseDown">

                    <Grid>


                        <DockPanel LastChildFill="False">
                            <core:OutlinedTextBlock Stroke="#333"
                                                    StrokePosition="Outside"
                                                    FontSize="24"
                                                    FontWeight="SemiBold"
                                                    Fill="WhiteSmoke"
                                                    StrokeThickness="1"
                                                    Text="Stats Client 2025"
                                                    VerticalAlignment="Bottom"
                                                    Margin="2,0,0,0">
                                <core:OutlinedTextBlock.LayoutTransform>
                                    <RotateTransform Angle="270" />
                                </core:OutlinedTextBlock.LayoutTransform>
                            </core:OutlinedTextBlock>

                        </DockPanel>
                        <TextBlock Text="{Binding SoftwareVersion, StringFormat='v\{0}'}"
                                   d:Text="v1"
                                   Margin="-4,0,0,186"
                                   HorizontalAlignment="Center"
                                   VerticalAlignment="Bottom"
                                   Foreground="Wheat"
                                   Panel.ZIndex="-1"
                                   FontSize="14" />
                    </Grid>
                </Border>

            </DockPanel>
            <!-- END OF TITLEBAR -->

            <!-- MAIN AREA -->

            <!--#region UNIT NUMBER DISPLAY -->
            <DockPanel Grid.Row="1"
                       Grid.Column="1"
                       VerticalAlignment="Top"
                       HorizontalAlignment="Right"
                       Margin="0,-2,45,0"
                       Panel.ZIndex="50"
                       Width="220"
                       LastChildFill="False"
                       Height="32">

                <core:OutlinedTextBlock Stroke="#333"
                                        StrokePosition="Outside"
                                        VerticalAlignment="Center"
                                        FontSize="22"
                                        Cursor="Hand"
                                        FontWeight="SemiBold"
                                        Fill="#ff809d"
                                        StrokeThickness="1"
                                        Text="{Binding SentOutIssuesCount}"
                                        Visibility="{Binding SentOutIssuesCount, Converter={StaticResource ZeroToCollapsedConverter}}"
                                        d:Visibility="Visible"
                                        d:Text="17"
                                        DockPanel.Dock="Right"
                                        Margin="0">
                    <i:Interaction.Triggers>
                        <i:EventTrigger EventName="MouseDown">
                            <i:InvokeCommandAction Command="{Binding SwitchToOrderIssuesTabCommand}" />
                        </i:EventTrigger>
                    </i:Interaction.Triggers>
                </core:OutlinedTextBlock>

                <core:OutlinedTextBlock Stroke="#333"
                                        StrokePosition="Outside"
                                        VerticalAlignment="Center"
                                        FontSize="14"
                                        FontWeight="SemiBold"
                                        Fill="PaleGreen"
                                        Cursor="Hand"
                                        ToolTip="Click here to start updating.."
                                        StrokeThickness="1"
                                        Text="Update available!"
                                        Visibility="{Binding UpdateAvailable, Converter={StaticResource BoolToVisibilityConverter}}"
                                        d:Visibility="Visible"
                                        DockPanel.Dock="Right"
                                        Margin="0,0,20,0">
                    <i:Interaction.Triggers>
                        <i:EventTrigger EventName="MouseDown">
                            <i:InvokeCommandAction Command="{Binding StartProgramUpdateCommand}" />
                        </i:EventTrigger>
                    </i:Interaction.Triggers>
                </core:OutlinedTextBlock>
            </DockPanel>
            <!--#endregion UNIT NUMBER DISPLAY -->

            <!--#region DESIGNER OPEN ICONS DISPLAY -->
            <DockPanel Grid.Row="1"
                       Grid.Column="1"
                       Background="Transparent"
                       Panel.ZIndex="10"
                       Height="27"
                       Margin="190,0,44,0"
                       VerticalAlignment="Top"
                       PreviewMouseDown="TitleBar_PreviewMouseDown">

                <StackPanel Orientation="Horizontal"
                            x:Name="panelDesignerOpen"
                            DockPanel.Dock="Left"
                            Margin="4,0,0,0">
                    <Image Source="/Images/ListViewIcons/psModelling.png"
                           Height="16"
                           ToolTip="{Binding DesignerOpenToolTip, StringFormat='\{0} case is opened for design'}"
                           Visibility="{Binding DesignerOpen, Converter={StaticResource BoolToVisibilityConverter}}"
                           d:Visibility="Visible">
                        <Image.BitmapEffect>
                            <DropShadowBitmapEffect Color="Orange"
                                                    Direction="270"
                                                    ShadowDepth="1"
                                                    Opacity="0.55"
                                                    Softness="2" />
                        </Image.BitmapEffect>
                    </Image>

                </StackPanel>
            </DockPanel>
            <!--#endregion DESIGNER OPEN ICONS DISPLAY -->

            <TabControl Grid.Row="1"
                        Grid.Column="1"
                        Background="Transparent"
                        BorderThickness="1,1,1,1"
                        BorderBrush="#777"
                        Style="{StaticResource mainTabControl}"
                        x:Name="mainTabControl"
                        SelectionChanged="TabControl_SelectionChanged">

                <!--#region 3SHAPE TAB -->
                <TabItem Header="3Shape Orders"
                         IsTabStop="False"
                         IsEnabled="{Binding ThreeShapeServerIsDown, Converter={StaticResource InverseBoolConverter}}"
                         x:Name="ThreeShapeTab">
                    <Grid Background="White"
                          Margin="-2">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="45" />
                            <RowDefinition />
                        </Grid.RowDefinitions>



                        <Grid Margin="0,0,0,0">
                            <Grid.Background>
                                <LinearGradientBrush StartPoint="0,0.5"
                                                     EndPoint="1,0.5">
                                    <GradientStop Color="#66696F"
                                                  Offset="0.0" />
                                    <GradientStop Color="#56595F"
                                                  Offset="0.15" />
                                    <GradientStop Color="#6b634e"
                                                  Offset="0.25" />
                                    <GradientStop Color="#56597F"
                                                  Offset="0.75" />
                                    <GradientStop Color="#56795F"
                                                  Offset="0.95" />
                                    <GradientStop Color="#56595F"
                                                  Offset="1.0" />
                                </LinearGradientBrush>
                            </Grid.Background>

                            <ProgressBar x:Name="pb3ShapeProgressBar"
                                         Panel.ZIndex="-1"
                                         Grid.Row="0"
                                         Grid.RowSpan="2"
                                         Grid.Column="0"
                                         Grid.ColumnSpan="2"
                                         Maximum="100"
                                         Minimum="0"
                                         Value="25"
                                         Foreground="LightGreen"
                                         Height="62"
                                         VerticalAlignment="Top"
                                         BorderThickness="0"
                                         Opacity="0.15"
                                         Background="Transparent"
                                         ClipToBounds="True"
                                         Margin="-4,0,-4,0" />

                            <DockPanel Grid.Row="1"
                                       LastChildFill="False">
                                <TextBlock Text="Group By:"
                                           VerticalAlignment="Top"
                                           FontSize="9"
                                           Padding="3,3,0,0"
                                           FontWeight="Normal" />

                                <TextBlock Text="Filters:"
                                           VerticalAlignment="Top"
                                           FontSize="9"
                                           Padding="100,3,0,0"
                                           FontWeight="Normal" />

                                <TextBlock Text="Selected order: "
                                           VerticalAlignment="Top"
                                           Margin="340,0,0,0"
                                           FontSize="10"
                                           Visibility="{Binding Text, ElementName=selectedOrderId, Converter={StaticResource EmptyToHiddenConverter}}" />
                                <TextBlock Text="{Binding ThreeShapeObject.IntOrderID}"
                                           x:Name="selectedOrderId"
                                           VerticalAlignment="Top"
                                           FontSize="11"
                                           Margin="0,0,8,0"
                                           TextTrimming="CharacterEllipsis"
                                           Foreground="BlanchedAlmond"
                                           FontWeight="SemiBold" />

                                <Grid VerticalAlignment="Top"
                                      DockPanel.Dock="Right"
                                      Width="246"
                                      Margin="0,0,8,0">

                                    <StackPanel Orientation="Horizontal"
                                                Visibility="{Binding ActiveFilterInUse, Converter={StaticResource EmptyToHiddenConverter}}"
                                                d:Visibility="Visible">
                                        <TextBlock Text="Result of: "
                                                   FontWeight="SemiBold"
                                                   Foreground="Beige"
                                                   FontSize="11"
                                                   Margin="0,1,0,0" />
                                        <TextBlock Text="{Binding ActiveFilterInUse}"
                                                   d:Text="Filter string"
                                                   FontWeight="SemiBold"
                                                   Foreground="BlanchedAlmond"
                                                   FontSize="11"
                                                   TextTrimming="CharacterEllipsis"
                                                   Margin="0,1,0,0" />
                                    </StackPanel>
                                    <StackPanel Orientation="Horizontal"
                                                Visibility="{Binding ActiveSearchString, Converter={StaticResource EmptyToHiddenConverter}}">
                                        <TextBlock Text="Searched for: "
                                                   FontWeight="SemiBold"
                                                   Foreground="Beige"
                                                   FontSize="11"
                                                   Margin="0,1,0,0" />
                                        <TextBlock Text="{Binding ActiveSearchString}"
                                                   FontWeight="SemiBold"
                                                   Foreground="BlanchedAlmond"
                                                   FontSize="11"
                                                   Margin="0,1,0,0" />
                                    </StackPanel>
                                    <TextBlock Text="{Binding OrderCountText}"
                                               d:Text="88 orders"
                                               Grid.Column="1"
                                               Foreground="Beige"
                                               HorizontalAlignment="Right"
                                               Margin="15,1,0,0" />
                                </Grid>

                            </DockPanel>
                            <DockPanel Grid.Row="1"
                                       Height="25"
                                       LastChildFill="False"
                                       Panel.ZIndex="10"
                                       Margin="2,3,0,3"
                                       Visibility="{Binding Is3ShapeTabSelected, Converter={StaticResource BoolToVisibilityConverter}}"
                                       VerticalAlignment="Bottom">

                                <ComboBox x:Name="GroupBy"
                                          ItemsSource="{Binding GroupBy}"
                                          SelectedItem="{Binding SelectedGroupByItem}"
                                          IsEnabled="{Binding FilterString, Converter={StaticResource MyRecentToFalseConverter}}"
                                          Width="130"
                                          Height="22"
                                          Margin="0,0,10,0"
                                          SelectedIndex="0">
                                    <i:Interaction.Triggers>
                                        <i:EventTrigger EventName="SelectionChanged">
                                            <i:InvokeCommandAction Command="{Binding GroupBySelectionChangedCommand}" />
                                        </i:EventTrigger>
                                    </i:Interaction.Triggers>
                                </ComboBox>


                                <Button  x:Name="btnMyRecent"
                                         Width="86"
                                         Height="22"
                                         Background="#77779F"
                                         Cursor="Hand"
                                         Margin="0,0,4,0"
                                         Command="{Binding FilterMenuItemCommand}"
                                         CommandParameter="MyRecent">

                                    <StackPanel Orientation="Horizontal">
                                        <Image  Source="/Images/FilterIcons/001_OrdersByDate22x22.png" />
                                        <TextBlock Text="My Recent"
                                                   VerticalAlignment="Center"
                                                   Margin="5,0" />
                                    </StackPanel>

                                    <Button.Resources>
                                        <Style TargetType="{x:Type Border}">
                                            <Setter Property="CornerRadius"
                                                    Value="1" />
                                        </Style>
                                    </Button.Resources>
                                </Button>
                                <Button  x:Name="btnToday"
                                         Width="80"
                                         Height="22"
                                         Background="#778777"
                                         Cursor="Hand"
                                         Margin="0,0,4,0"
                                         Command="{Binding FilterMenuItemCommand}"
                                         CommandParameter="Today">

                                    <StackPanel Orientation="Horizontal">
                                        <Image  Source="/Images/FilterIcons/001_OrdersByDate22x22.png" />
                                        <TextBlock Text="Today"
                                                   VerticalAlignment="Center"
                                                   Margin="5,0" />
                                    </StackPanel>

                                    <Button.Resources>
                                        <Style TargetType="{x:Type Border}">
                                            <Setter Property="CornerRadius"
                                                    Value="1" />
                                        </Style>
                                    </Button.Resources>
                                </Button>

                                <Button  x:Name="btnFilterByDate"
                                         Width="80"
                                         Height="22"
                                         Cursor="Hand"
                                         Margin="0,0,4,0"
                                         ContextMenuService.Placement="Bottom"
                                         PreviewMouseDown="BtnFilter_PreviewMouseDown">

                                    <StackPanel Orientation="Horizontal">
                                        <Image  Source="/Images/FilterIcons/001_OrdersByDate22x22.png" />
                                        <TextBlock Text="By Date"
                                                   VerticalAlignment="Center"
                                                   Margin="5,0" />
                                    </StackPanel>

                                    <Button.Resources>
                                        <Style TargetType="{x:Type Border}">
                                            <Setter Property="CornerRadius"
                                                    Value="1" />
                                        </Style>
                                    </Button.Resources>

                                    <Button.ContextMenu>
                                        <ContextMenu>
                                            <!--MenuItem Header="Today"
                                                      Command="{Binding FilterMenuItemCommand}"
                                                      CommandParameter="Today">
                                                <MenuItem.Icon>
                                                    <Image  Source="/Images/FilterIcons/001_OrdersByDate22x22.png" />
                                                </MenuItem.Icon>
                                            </MenuItem-->
                                            <MenuItem Header="Yesterday"
                                                      CommandParameter="Yesterday"
                                                      Command="{Binding FilterMenuItemCommand}">
                                                <MenuItem.Icon>
                                                    <Image  Source="/Images/FilterIcons/002_OrdersByDateToday22x22.png" />
                                                </MenuItem.Icon>
                                            </MenuItem>
                                            <Separator Margin="0,10" />
                                            <MenuItem Header="Last Two Days"
                                                      CommandParameter="LastTwoDays"
                                                      Command="{Binding FilterMenuItemCommand}">
                                                <MenuItem.Icon>
                                                    <Image  Source="/Images/FilterIcons/003_OrdersByDateLastTwoDays22x22.png" />
                                                </MenuItem.Icon>
                                            </MenuItem>
                                            <Separator Margin="0,10" />
                                            <MenuItem Header="This Week"
                                                      CommandParameter="ThisWeek"
                                                      Command="{Binding FilterMenuItemCommand}">
                                                <MenuItem.Icon>
                                                    <Image  Source="/Images/FilterIcons/004_OrdersByDateLastWeek22x22.png" />
                                                </MenuItem.Icon>
                                            </MenuItem>
                                            <MenuItem Header="This and Last Week"
                                                      CommandParameter="ThisAndLastWeek"
                                                      Command="{Binding FilterMenuItemCommand}">
                                                <MenuItem.Icon>
                                                    <Image  Source="/Images/FilterIcons/005_OrdersByDateLastTwoWeeks22x22.png" />
                                                </MenuItem.Icon>
                                            </MenuItem>
                                            <Separator Margin="0,10" />
                                            <MenuItem Header="Last 30 days"
                                                      CommandParameter="LastMonth"
                                                      Command="{Binding FilterMenuItemCommand}">
                                                <MenuItem.Icon>
                                                    <Image  Source="/Images/FilterIcons/005_OrdersByDateLastTwoWeeks22x22.png" />
                                                </MenuItem.Icon>
                                            </MenuItem>
                                        </ContextMenu>
                                    </Button.ContextMenu>
                                </Button>

                                <Button  x:Name="btnFilterByStatus"
                                         Width="80"
                                         Height="22"
                                         Cursor="Hand"
                                         Margin="0,0,4,0"
                                         ContextMenuService.Placement="Bottom"
                                         PreviewMouseDown="BtnFilter_PreviewMouseDown">
                                    <StackPanel Orientation="Horizontal">
                                        <Image  Source="/Images/FilterIcons/006_OrdersByStatus22x22.png" />
                                        <TextBlock Text="By Status"
                                                   VerticalAlignment="Center"
                                                   Margin="5,0" />
                                    </StackPanel>
                                    <Button.Resources>
                                        <Style TargetType="{x:Type Border}">
                                            <Setter Property="CornerRadius"
                                                    Value="1" />
                                        </Style>
                                    </Button.Resources>


                                    <Button.ContextMenu>
                                        <ContextMenu>
                                            <MenuItem Header="Waiting for Send"
                                                      CommandParameter="NeverSentAbutments"
                                                      Command="{Binding FilterMenuItemCommand}">
                                                <MenuItem.Icon>
                                                    <Image  Source="/Images/FilterIcons/notSentOut_28.png" />
                                                </MenuItem.Icon>
                                            </MenuItem>
                                            <Separator Margin="0,10" />
                                            <MenuItem Header="Created / entered cases"
                                                      CommandParameter="Created"
                                                      Command="{Binding FilterMenuItemCommand}">
                                                <MenuItem.Icon>
                                                    <Image  Source="/Images/FilterIcons/007_OrderStatusCreated22x22.png" />
                                                </MenuItem.Icon>
                                            </MenuItem>
                                            <MenuItem Header="Scanned cases"
                                                      CommandParameter="Scanned"
                                                      Command="{Binding FilterMenuItemCommand}">
                                                <MenuItem.Icon>
                                                    <Image  Source="/Images/FilterIcons/009_OrderStatusScanned22x22.png" />
                                                </MenuItem.Icon>
                                            </MenuItem>
                                            <Separator Margin="0,10" />
                                            <MenuItem Header="Scanned cases (impressions)"
                                                      CommandParameter="ImpressionScans"
                                                      Command="{Binding FilterMenuItemCommand}">
                                                <MenuItem.Icon>
                                                    <Image  Source="/Images/FilterIcons/22x22_3DBitePlate.png" />
                                                </MenuItem.Icon>
                                            </MenuItem>
                                            <MenuItem Header="Scanned cases (model)"
                                                      CommandParameter="ModelScans"
                                                      Command="{Binding FilterMenuItemCommand}">
                                                <MenuItem.Icon>
                                                    <Image  Source="/Images/FilterIcons/22x22_preparation.png" />
                                                </MenuItem.Icon>
                                            </MenuItem>
                                            <MenuItem Header="Received cases (digital scans)"
                                                      CommandParameter="DigitalScans"
                                                      Command="{Binding FilterMenuItemCommand}">
                                                <MenuItem.Icon>
                                                    <Image  Source="/Images/FilterIcons/025_OrderStatusScannedTrios22x22.png" />
                                                </MenuItem.Icon>
                                            </MenuItem>

                                            <Separator Margin="0,10" />

                                            <MenuItem Header="Designed cases"
                                                      CommandParameter="Designed"
                                                      Command="{Binding FilterMenuItemCommand}">
                                                <MenuItem.Icon>
                                                    <Image  Source="/Images/FilterIcons/012_OrderStatusModelling22x22.png" />
                                                </MenuItem.Icon>
                                            </MenuItem>
                                            <MenuItem Header="Design in progress"
                                                      CommandParameter="Designing"
                                                      Command="{Binding FilterMenuItemCommand}">
                                                <MenuItem.Icon>
                                                    <Image  Source="/Images/FilterIcons/psModelling.png" />
                                                </MenuItem.Icon>
                                            </MenuItem>
                                            <MenuItem Header="Sent to manufacturer"
                                                      CommandParameter="Sent"
                                                      Command="{Binding FilterMenuItemCommand}">
                                                <MenuItem.Icon>
                                                    <Image  Source="/Images/FilterIcons/028_OrdersSent22x22.png" />
                                                </MenuItem.Icon>
                                            </MenuItem>
                                            <MenuItem Header="Closed cases"
                                                      CommandParameter="Closed"
                                                      Command="{Binding FilterMenuItemCommand}">
                                                <MenuItem.Icon>
                                                    <Image  Source="/Images/FilterIcons/018_OrderStatusClosed22x22.png" />
                                                </MenuItem.Icon>
                                            </MenuItem>
                                            <Separator Margin="0,10" />
                                            <MenuItem Header="Not Checked Out yet"
                                                      CommandParameter="NotCheckedOut"
                                                      Command="{Binding FilterMenuItemCommand}">
                                                <MenuItem.Icon>
                                                    <Image  Source="/Images/FilterIcons/009_OrderStatusScanned22x22.png" />
                                                </MenuItem.Icon>
                                            </MenuItem>
                                            <MenuItem Header="Checked Out cases"
                                                      CommandParameter="CheckedOut"
                                                      Command="{Binding FilterMenuItemCommand}">
                                                <MenuItem.Icon>
                                                    <Image  Source="/Images/FilterIcons/orders_CheckedOut.png" />
                                                </MenuItem.Icon>
                                            </MenuItem>
                                        </ContextMenu>
                                    </Button.ContextMenu>
                                </Button>

                                <Button x:Name="btnFilterByType"
                                        Width="80"
                                        Height="22"
                                        Margin="0,0,4,0"
                                        Cursor="Hand"
                                        ContextMenuService.Placement="Bottom"
                                        PreviewMouseDown="BtnFilter_PreviewMouseDown">
                                    <StackPanel Orientation="Horizontal">
                                        <Image Height="16"
                                               Source="/Images/FilterIcons/035_InboxRoot22x22.png" />
                                        <TextBlock Text="By Type"
                                                   VerticalAlignment="Center"
                                                   Margin="5,0" />
                                    </StackPanel>
                                    <Button.Resources>
                                        <Style TargetType="{x:Type Border}">
                                            <Setter Property="CornerRadius"
                                                    Value="1" />
                                        </Style>
                                    </Button.Resources>

                                    <Button.ContextMenu>
                                        <ContextMenu>
                                            <MenuItem Header="All Digital Models"
                                                      CommandParameter="DigitalModels"
                                                      Command="{Binding FilterMenuItemCommand}">
                                                <MenuItem.Icon>
                                                    <Image  Source="/Images/FilterIcons/22x22_DigitalModel.png" />
                                                </MenuItem.Icon>
                                            </MenuItem>
                                            <Separator Margin="0,10" />
                                            <MenuItem Header="Impression cases"
                                                      CommandParameter="ImpressionAll"
                                                      Command="{Binding FilterMenuItemCommand}">
                                                <MenuItem.Icon>
                                                    <Image  Source="/Images/FilterIcons/22x22_3DBitePlate.png" />
                                                </MenuItem.Icon>
                                            </MenuItem>
                                            <MenuItem Header="Model cases"
                                                      CommandParameter="ModelAll"
                                                      Command="{Binding FilterMenuItemCommand}">
                                                <MenuItem.Icon>
                                                    <Image  Source="/Images/FilterIcons/22x22_preparation.png" />
                                                </MenuItem.Icon>
                                            </MenuItem>
                                            <MenuItem Header="Digital Impression cases"
                                                      CommandParameter="DigitalAll"
                                                      Command="{Binding FilterMenuItemCommand}">
                                                <MenuItem.Icon>
                                                    <Image  Source="/Images/FilterIcons/025_OrderStatusScannedTrios22x22.png" />
                                                </MenuItem.Icon>
                                            </MenuItem>
                                        </ContextMenu>
                                    </Button.ContextMenu>
                                </Button>

                                <DockPanel Margin="8,0,0,0"
                                           LastChildFill="False">
                                    <Button Width="28"
                                            Height="22"
                                            Margin="0,0,4,0"
                                            Command="{Binding OpenUpOrderInfoWindowCommand}"
                                            d:Visibility="Visible"
                                            Visibility="{Binding TBBOpenDetails}">
                                        <Image Source="\Images\ToolBar\open.png"
                                               Width="20"
                                               Height="20" />
                                    </Button>
                                    <Button Width="28"
                                            Height="22"
                                            Margin="0,0,4,0"
                                            Command="{Binding GenerateStCopyCommand}"
                                            d:Visibility="Visible"
                                            Visibility="{Binding TBBGenerateStCopy}">
                                        <Image Source="\Images\ToolBar\stcopy.png"
                                               Width="20"
                                               Height="20" />
                                    </Button>

                                    <Button Width="28"
                                            Height="22"
                                            Margin="0,0,4,0"
                                            Command="{Binding OpenUpRenameOrderWindowCommand}"
                                            d:Visibility="Visible"
                                            Visibility="{Binding TBBRename}">
                                        <Image Source="\Images\ToolBar\rename.png"
                                               Width="20"
                                               Height="20" />
                                    </Button>
                                </DockPanel>

                                <Grid Margin="20,0,5,0"
                                      Width="250"
                                      Height="22"
                                      DockPanel.Dock="Right">

                                    <TextBox x:Name="tbSearch"
                                             Grid.Column="2"
                                             Height="22"
                                             FontSize="14"
                                             Padding="4,1,2,0"
                                             Text="{Binding SearchString, UpdateSourceTrigger=PropertyChanged}"
                                             Width="250"
                                             Style="{StaticResource SearchBox}">
                                        <TextBox.InputBindings>
                                            <KeyBinding Command="{Binding SearchFieldKeyDownCommand}"
                                                        Key="Enter" />
                                        </TextBox.InputBindings>
                                    </TextBox>


                                    <TextBlock x:Name="lblSearchWatermark"
                                               Text="Search here.."
                                               Grid.Column="2"
                                               FontSize="13"
                                               Foreground="Beige"
                                               Padding="8,3,2,0"
                                               Visibility="{Binding Text, ElementName=tbSearch,
                                                            Converter={StaticResource EmptyToVisibleConverter}}">

                                        <i:Interaction.Triggers>
                                            <i:EventTrigger EventName="MouseDown">
                                                <i:InvokeCommandAction Command="{Binding SearchFieldClickedCommand}" />
                                            </i:EventTrigger>
                                        </i:Interaction.Triggers>
                                    </TextBlock>
                                </Grid>
                            </DockPanel>
                        </Grid>

                        

                        <StackPanel Orientation="Vertical"
                                    Grid.Row="1"
                                    HorizontalAlignment="Right"
                                    VerticalAlignment="Bottom"
                                    Margin="0,0,20,10"
                                    Panel.ZIndex="1">
                            <Image Source="/Images/stats_2025_Q512.png"
                                   Grid.Row="1"
                                   Height="110"
                                   Width="110"
                                   Panel.ZIndex="1"
                                   Margin="-127,0,0,0"
                                   Opacity="1"/>
                            <core:OutlinedTextBlock Stroke="#000"
                                                    StrokePosition="Outside"
                                                    FontSize="70"
                                                    FontWeight="SemiBold"
                                                    Fill="OrangeRed"
                                                    StrokeThickness="1"
                                                    Margin="0,-42,0,0"
                                                    VerticalAlignment="Center"
                                                    Text="Stats Systems"
                                                    Opacity="0.80"
                                                    Panel.ZIndex="2" />
                            
                            <core:OutlinedTextBlock Stroke="#000"
                                                    StrokePosition="Outside"
                                                    FontSize="14"
                                                    FontWeight="SemiBold"
                                                    Fill="Black"
                                                    StrokeThickness="1"
                                                    Margin="156,-17,0,0"
                                                    VerticalAlignment="Center"
                                                    Text="by AmL"
                                                    Opacity="0.80"
                                                    Panel.ZIndex="2" />
                        </StackPanel>

                        <TextBlock Name="empty"
                                   Grid.Row="1"
                                   Panel.ZIndex="3"
                                   Text="No items found"
                                   Foreground="Black"
                                   Visibility="{Binding OrderCount, Converter={StaticResource ZeroToVisibleConverter}}"
                                   HorizontalAlignment="Center"
                                   VerticalAlignment="Center" />

                        <Border Grid.Row="1"
                                Panel.ZIndex="2"
                                BorderBrush="#777"
                                BorderThickness="0,1,0,0"
                                Opacity="0.93">

                            <ListView x:Name="listView3ShapeOrders"
                                      ScrollViewer.CanContentScroll="False"
                                      BorderThickness="0,0,0,0"
                                      Margin="0,-1,0,0"
                                      MouseDown="listView3ShapeOrders_MouseDown"
                                      BorderBrush="#666"
                                      AlternationCount="2"
                                      SelectedItem="{Binding SelectedItem}"
                                      ItemContainerStyle="{StaticResource LvItemDetailed}">
                                <ListView.View>

                                    <GridView AllowsColumnReorder="False">
                                        <GridViewColumn x:Name="headerIcon"
                                                        Width="47"
                                                        DisplayMemberBinding="{Binding PanNumber}">
                                            <GridViewColumn.Header>
                                                <GridViewColumnHeader Template="{StaticResource CustomHeader}"
                                                                      SizeChanged="GridViewColumnHeader_SizeChanged" />
                                            </GridViewColumn.Header>
                                        </GridViewColumn>
                                        <GridViewColumn x:Name="headerCaseID"
                                                        Width="400"
                                                        DisplayMemberBinding="{Binding IntOrderID}">
                                            <GridViewColumn.Header>
                                                <GridViewColumnHeader Template="{StaticResource CustomHeader}"
                                                                      Tag="  Case ID" />
                                            </GridViewColumn.Header>
                                        </GridViewColumn>


                                        <GridViewColumn x:Name="headerPrescription"
                                                        Width="30">
                                            <GridViewColumn.Header>
                                                <GridViewColumnHeader Template="{StaticResource CustomHeader}"
                                                                      Tag="   Rx" />
                                            </GridViewColumn.Header>
                                        </GridViewColumn>
                                        <GridViewColumn x:Name="headerScanInfo"
                                                        Width="140"
                                                        DisplayMemberBinding="{Binding ScanSource}">
                                            <GridViewColumn.Header>
                                                <GridViewColumnHeader Template="{StaticResource CustomHeader}"
                                                                      Tag="  Scan Info" />
                                            </GridViewColumn.Header>
                                        </GridViewColumn>
                                        <GridViewColumn x:Name="headerCustomer"
                                                        Width="242"
                                                        DisplayMemberBinding="{Binding Customer}">
                                            <GridViewColumn.Header>
                                                <GridViewColumnHeader Template="{StaticResource CustomHeader}"
                                                                      Tag="  Customer + Patient" />
                                            </GridViewColumn.Header>
                                        </GridViewColumn>
                                        <GridViewColumn x:Name="headerItems"
                                                        Width="400"
                                                        DisplayMemberBinding="{Binding Items}">
                                            <GridViewColumn.Header>
                                                <GridViewColumnHeader Template="{StaticResource CustomHeader}"
                                                                      Tag="  Items" />
                                            </GridViewColumn.Header>
                                        </GridViewColumn>
                                        <GridViewColumn x:Name="headerDates"
                                                        Width="1560"
                                                        DisplayMemberBinding="{Binding Patient_LastName}">
                                            <GridViewColumn.Header>
                                                <GridViewColumnHeader Template="{StaticResource CustomHeader}" />
                                            </GridViewColumn.Header>
                                        </GridViewColumn>

                                    </GridView>

                                </ListView.View>


                                <ListView.GroupStyle>
                                    <GroupStyle>
                                        <GroupStyle.ContainerStyle>
                                            <Style TargetType="{x:Type GroupItem}">
                                                <Setter Property="Template">
                                                    <Setter.Value>
                                                        <ControlTemplate>
                                                            <Expander IsExpanded="True"
                                                                      Margin="0,10,0,0"
                                                                      x:Name="expander">

                                                                <i:Interaction.Triggers>
                                                                    <i:EventTrigger EventName="Loaded">
                                                                        <i:InvokeCommandAction Command="{Binding DataContext.ExpanderLoadedCommand, 
                                                                                                     RelativeSource={RelativeSource Mode=FindAncestor, AncestorType={x:Type Window}}}"
                                                                                               CommandParameter="{Binding ElementName=expander}" />
                                                                    </i:EventTrigger>
                                                                    <i:EventTrigger EventName="Collapsed">
                                                                        <i:InvokeCommandAction Command="{Binding DataContext.ExpanderCollapsedCommand, 
                                                                                                     RelativeSource={RelativeSource Mode=FindAncestor, AncestorType={x:Type Window}}}"
                                                                                               CommandParameter="{Binding ElementName=expander}" />
                                                                    </i:EventTrigger>
                                                                    <i:EventTrigger EventName="Expanded">
                                                                        <i:InvokeCommandAction Command="{Binding DataContext.ExpanderCollapsedCommand, 
                                                                                                     RelativeSource={RelativeSource Mode=FindAncestor, AncestorType={x:Type Window}}}"
                                                                                               CommandParameter="{Binding ElementName=expander}" />
                                                                    </i:EventTrigger>
                                                                </i:Interaction.Triggers>
                                                                <Expander.Header>
                                                                    <Grid>
                                                                        <Grid.ColumnDefinitions>
                                                                            <ColumnDefinition Width="auto" />
                                                                            <ColumnDefinition Width="auto" />
                                                                            <ColumnDefinition Width="auto" />
                                                                            <ColumnDefinition />
                                                                        </Grid.ColumnDefinitions>


                                                                        <TextBlock Grid.Column="0"
                                                                                   Text="{Binding Name, Converter={StaticResource RemoveIDTagFromFrontConverter}}"
                                                                                   FontWeight="Bold"
                                                                                   Foreground="Gray"
                                                                                   FontSize="13"
                                                                                   VerticalAlignment="Center" />
                                                                        <TextBlock Grid.Column="1"
                                                                                   Text="{Binding ItemCount}"
                                                                                   FontSize="13"
                                                                                   Foreground="Green"
                                                                                   FontWeight="Bold"
                                                                                   FontStyle="Italic"
                                                                                   Margin="6,0,0,0"
                                                                                   VerticalAlignment="Center" />
                                                                        <TextBlock Grid.Column="2"
                                                                                   Text=" case(s)"
                                                                                   FontSize="13"
                                                                                   Foreground="Silver"
                                                                                   FontStyle="Italic"
                                                                                   VerticalAlignment="Center" />
                                                                        <Line Grid.Column="3"
                                                                              X1='0'
                                                                              X2="{Binding ActualWidth, Mode=OneWay, 
                                                           RelativeSource={RelativeSource FindAncestor,
                                                           AncestorType={x:Type localView:MainWindow}}}"
                                                                              Y1='10'
                                                                              Y2='10'
                                                                              Stroke="LightGray"
                                                                              StrokeThickness='1'
                                                                              Margin="5,0,-1800,0" />
                                                                    </Grid>
                                                                </Expander.Header>
                                                                <ItemsPresenter />

                                                            </Expander>

                                                        </ControlTemplate>

                                                    </Setter.Value>
                                                </Setter>
                                            </Style>
                                        </GroupStyle.ContainerStyle>
                                    </GroupStyle>
                                </ListView.GroupStyle>




                            </ListView>
                        </Border>
                    </Grid>
                </TabItem>
                <!--#endregion 3SHAPE TAB -->












                <!--#region APPLICATIONS TAB -->
                <TabItem Header="Applications"
                         IsTabStop="False"
                         x:Name="applicationsTab">
                    <TabControl BorderThickness="1,0,0,0"
                                Margin="4,-1,-2,-2"
                                Style="{StaticResource applicationsTabControl}"
                                x:Name="applicationsTabControl"
                                TabStripPlacement="Left">
                        <TabControl.Background>
                            <SolidColorBrush Color="#66696F"
                                             Opacity="0.25" />
                        </TabControl.Background>

                        <TabItem Header="Sent out Cases"
                                 IsTabStop="False"
                                 Style="{StaticResource applicationsTabItem}">
                            <Grid>
                                <Grid Visibility="{Binding ThreeShapeServerIsDown, Converter={StaticResource BoolToInverseVisibilityConverter}}"
                                      d:Visibility="Visible">
                                    <localView:SentOutCasesPage DataContext="{Binding SentOutCasesViewModel}" />
                                </Grid>

                                <Grid VerticalAlignment="Center"
                                      HorizontalAlignment="Center"
                                      Visibility="{Binding ThreeShapeServerIsDown, Converter={StaticResource BoolToVisibilityConverter}}"
                                      d:Visibility="Visible">
                                    <TextBlock Text="No connection to 3Shape Server" />
                                </Grid>
                            </Grid>
                        </TabItem>

                        <TabItem Header="Account Infos"
                                 IsTabStop="False"
                                 Visibility="{Binding CbSettingModuleAccountInfos, Converter={StaticResource BoolToVisibilityConverter}}"
                                 d:Visibility="Visible"
                                 x:Name="tabAccountInfos"
                                 Style="{StaticResource applicationsTabItem}">
                            <Grid>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="30" />
                                    <RowDefinition />
                                </Grid.RowDefinitions>

                                <Grid Margin="0,4,0,0">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="auto" />
                                        <ColumnDefinition Width="200" />
                                        <ColumnDefinition Width="60" />
                                        <ColumnDefinition Width="auto" />
                                        <ColumnDefinition />
                                    </Grid.ColumnDefinitions>

                                    <TextBlock Text="Search:"
                                               FontWeight="Thin"
                                               FontSize="14"
                                               VerticalAlignment="Center"
                                               Margin="4" />

                                    <TextBox Grid.Column="1"
                                             FontSize="14"
                                             Padding="10"
                                             Background="#444"
                                             Foreground="Beige"
                                             x:Name="tbSearchAccInfos"
                                             Height="24"
                                             Text="{Binding SearchInAccountInfos, UpdateSourceTrigger=PropertyChanged}" />
                                    <Button Content="Clear"
                                            Grid.Column="2"
                                            Height="23"
                                            Margin="5,0,0,0"
                                            Visibility="{Binding SearchInAccountInfos, Converter={StaticResource EmptyToHiddenConverter}}"
                                            d:Visibility="Visible"
                                            Command="{Binding ClearAccInfoSearchCommand}" />

                                    <TextBlock Text="Category:"
                                               Grid.Column="3"
                                               FontWeight="Thin"
                                               FontSize="14"
                                               VerticalAlignment="Center"
                                               Margin="14,4,4,4" />

                                    <ComboBox Grid.Column="4"
                                              Width="150"
                                              Height="24"
                                              Margin="5,0,0,0"
                                              HorizontalAlignment="Left"
                                              SelectedItem="{Binding SelectedAccountInfoCategory}"
                                              ItemsSource="{Binding AccountInfoCategories}" />
                                </Grid>


                                <ListView Grid.Row="1"
                                          Background="Transparent"
                                          BorderThickness="0"
                                          ItemsSource="{Binding AccountInfoList}"
                                          ItemContainerStyle="{StaticResource LvItemAccountInfo}" />
                            </Grid>
                        </TabItem>

                        <TabItem Header="Folder Subscription"
                                 x:Name="folderSubscriptionTab"
                                 IsTabStop="False"
                                 Visibility="{Binding CbSettingModuleFolderSubscription, Converter={StaticResource BoolToVisibilityConverter}}"
                                 d:Visibility="Visible"
                                 Style="{StaticResource applicationsTabItem}">
                            <Grid Margin="0,-4,-2,0">
                                <Grid.RowDefinitions>
                                    <RowDefinition  Height="30" />
                                    <RowDefinition />
                                    <RowDefinition Height="auto" />
                                </Grid.RowDefinitions>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition />
                                    <ColumnDefinition Width="8" />
                                    <ColumnDefinition Width="110" />
                                </Grid.ColumnDefinitions>

                                <DockPanel Grid.Column="0"
                                           Grid.ColumnSpan="3">

                                    <StackPanel Orientation="Horizontal">
                                        <Button Width="28"
                                                Height="22"
                                                Margin="1,0,4,0"
                                                ToolTip="Create &amp; Open up Today Folder"
                                                Command="{Binding FsCreateTodayFolderCommand}">
                                            <Image Source="\Images\ToolBar\new_folder.png"
                                                   Width="26"
                                                   Height="26"
                                                   Margin="0,-2,0,0" />
                                        </Button>

                                        <TextBlock Text="Search for"
                                                   VerticalAlignment="Center"
                                                   Margin="7,0,5,0" />
                                        <TextBox Width="250"
                                                 Height="22"
                                                 Foreground="Black"
                                                 FontSize="14"
                                                 Margin="0,0,0,0"
                                                 Text="{Binding FsSearchString, UpdateSourceTrigger=PropertyChanged}">
                                            <TextBox.InputBindings>
                                                <KeyBinding Key="Enter"
                                                            Command="{Binding FsSearchFoldersCommand}" />
                                            </TextBox.InputBindings>
                                        </TextBox>

                                        <Button Content="Search / Update"
                                                Width="110"
                                                Height="22"
                                                Margin="5,0"
                                                Visibility="Collapsed"
                                                Command="{Binding FsSearchFoldersCommand}" />

                                        <TextBlock Text="Target folder:"
                                                   VerticalAlignment="Center"
                                                   Margin="8,0,4,0" />
                                        <TextBlock Text="{Binding FsubscrTargetFolder}"
                                                   d:Text="C:\"
                                                   Foreground="LightGreen"
                                                   VerticalAlignment="Center"
                                                   Margin="0,0,4,0" />
                                    </StackPanel>

                                    <Button Content="Select target folder"
                                            Width="110"
                                            Height="22"
                                            Margin="5,0,2,0"
                                            HorizontalAlignment="Right"
                                            Command="{Binding SelectTargetFolderCommand}" />
                                </DockPanel>

                               

                                <Border Grid.Row="1"
                                        Grid.Column="0"
                                        BorderBrush="#CCC"
                                        BorderThickness="0,0,0,0">

                                    <ListView x:Name="listViewFolderSubscription"
                                              ScrollViewer.CanContentScroll="False"
                                              SelectionMode="Single"
                                              BorderThickness="0,1,0,0"
                                              BorderBrush="#AAA"
                                              Margin="-1"
                                              ItemsSource="{Binding FolderSubscriptionList}"
                                              ItemContainerStyle="{StaticResource LvItemFolderSubscription}"
                                              AlternationCount="2">


                                        <ListView.View>

                                            <GridView AllowsColumnReorder="False">
                                                <GridViewColumn x:Name="fsIcon"
                                                                Width="25"
                                                                DisplayMemberBinding="{Binding Icon}">
                                                    <GridViewColumn.Header>
                                                        <GridViewColumnHeader Template="{StaticResource CustomHeader}" />
                                                    </GridViewColumn.Header>
                                                </GridViewColumn>
                                                <GridViewColumn x:Name="fsName"
                                                                Width="250"
                                                                DisplayMemberBinding="{Binding FolderName}">
                                                    <GridViewColumn.Header>
                                                        <GridViewColumnHeader Template="{StaticResource CustomHeader}"
                                                                              Tag="  Name" />
                                                    </GridViewColumn.Header>
                                                </GridViewColumn>
                                                <GridViewColumn x:Name="fsLastModified"
                                                                Width="250"
                                                                DisplayMemberBinding="{Binding LastModified}">
                                                    <GridViewColumn.Header>
                                                        <GridViewColumnHeader Template="{StaticResource CustomHeader}"
                                                                              Tag="  Last modified" />
                                                    </GridViewColumn.Header>
                                                </GridViewColumn>


                                                <GridViewColumn x:Name="fsAge"
                                                                Width="140"
                                                                DisplayMemberBinding="{Binding Age}">
                                                    <GridViewColumn.Header>
                                                        <GridViewColumnHeader Template="{StaticResource CustomHeader}"
                                                                              Tag="  Age" />
                                                    </GridViewColumn.Header>
                                                </GridViewColumn>

                                            </GridView>

                                        </ListView.View>
                                    </ListView>
                                </Border>

                                <Grid Grid.Row="1"
                                      Grid.RowSpan="2"
                                      Grid.Column="2">
                                    <Grid.RowDefinitions>
                                        <RowDefinition />
                                        <RowDefinition Height="19" />
                                    </Grid.RowDefinitions>
                                    <DockPanel Grid.Row="0">
                                        <TextBlock Text="Waiting for collect"
                                                   HorizontalAlignment="Center"
                                                   DockPanel.Dock="Top"
                                                   Margin="0,0,0,0" />
                                        <TextBlock Text="{Binding SelectedPendingDigiNumber}"
                                                   d:Text="1002"
                                                   DockPanel.Dock="Top"
                                                   HorizontalAlignment="Center"
                                                   FontSize="20"
                                                   Foreground="Yellow"
                                                   Margin="0,0,0,4" />
                                        <ListView Width="100"
                                                  x:Name="listviewPendingDigiNumbers"
                                                  Margin="0,0,0,0"
                                                  SelectionMode="Single"
                                                  DockPanel.Dock="Top"
                                                  ItemsSource="{Binding PendingDigiNumbersWaitingToCollect}"
                                                  SelectedItem="{Binding SelectedPendingDigiNumber, Mode=TwoWay}">
                                            <ListView.View>
                                                <GridView ColumnHeaderContainerStyle="{StaticResource HiddenHeaderStyle}">
                                                    <GridViewColumn Width="90"
                                                                    DisplayMemberBinding="{Binding}" />
                                                </GridView>
                                            </ListView.View>
                                        </ListView>
                                    </DockPanel>
                                    <Button Content="Refresh list"
                                            Height="16"
                                            Width="98"
                                            FontSize="10"
                                            Command="{Binding ForceUpdatePendingDigiNumberListCommand}"
                                            VerticalAlignment="Bottom"
                                            Grid.Row="1" />
                                </Grid>

                                <StackPanel Grid.Row="2"
                                            Orientation="Horizontal">
                                    <TextBlock Text="Indexed directories:"
                                               VerticalAlignment="Center"
                                               FontWeight="Thin"
                                               Margin="2,4,0,0" />
                                    <TextBlock Text="{Binding FsCountedEntries}"
                                               d:Text="2518"
                                               Foreground="LightGreen"
                                               VerticalAlignment="Center"
                                               FontWeight="Thin"
                                               Cursor="Hand"
                                               Margin="4,4,0,0" />

                                    <TextBlock Text="Last folder scan:"
                                               VerticalAlignment="Center"
                                               FontWeight="Thin"
                                               Margin="12,4,0,0" />
                                    <TextBlock Text="{Binding FsLastDatabaseUpdate}"
                                               d:Text="date"
                                               Foreground="Yellow"
                                               VerticalAlignment="Center"
                                               FontWeight="Thin"
                                               Cursor="Hand"
                                               Margin="4,4,0,0">
                                        <i:Interaction.Triggers>
                                            <i:EventTrigger EventName="MouseDown">
                                                <i:InvokeCommandAction Command="{Binding FsTriggerUpdateRequestCommand}" />
                                            </i:EventTrigger>
                                        </i:Interaction.Triggers>
                                    </TextBlock>
                                </StackPanel>
                            </Grid>
                        </TabItem>

                        <TabItem Header="Prescription Maker"
                                 x:Name="prescriptionMakerTab"
                                 IsTabStop="False"
                                 Visibility="{Binding CbSettingModulePrescriptionMaker, Converter={StaticResource BoolToVisibilityConverter}}"
                                 d:Visibility="Visible"
                                 Style="{StaticResource applicationsTabItem}">
                            <Grid Margin="5">
                                <Grid.RowDefinitions>
                                    <RowDefinition />
                                    <RowDefinition Height="70" />
                                    <RowDefinition Height="75" />
                                    <RowDefinition Height="50" />
                                </Grid.RowDefinitions>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition MaxWidth="690" />
                                    <ColumnDefinition />
                                </Grid.ColumnDefinitions>

                                <Border Background="#777"
                                        BorderBrush="#999"
                                        BorderThickness="1"
                                        Grid.Column="0"
                                        Grid.Row="0">
                                    <WrapPanel x:Name="pmPanelPanek"
                                               Orientation="Horizontal">
                                        <Border Background="Red"
                                                Width="70"
                                                Height="36"
                                                Margin="3"
                                                HorizontalAlignment="Left"
                                                VerticalAlignment="Top"
                                                CornerRadius="2">
                                            <Grid Background="White"
                                                  Margin="8,6">
                                                <Border BorderBrush="#DDD"
                                                        BorderThickness="1">

                                                    <TextBlock Text="18008"
                                                               Foreground="Black"
                                                               FontWeight="SemiBold"
                                                               HorizontalAlignment="Center"
                                                               FontSize="16" />
                                                </Border>
                                            </Grid>
                                        </Border>
                                        <Border Background="Blue"
                                                Width="70"
                                                Height="36"
                                                Margin="3"
                                                HorizontalAlignment="Left"
                                                VerticalAlignment="Top"
                                                CornerRadius="2">
                                            <Grid Background="White"
                                                  Margin="8,6">
                                                <Border BorderBrush="#DDD"
                                                        BorderThickness="1">

                                                    <TextBlock Text="18008"
                                                               Foreground="Black"
                                                               FontWeight="SemiBold"
                                                               HorizontalAlignment="Center"
                                                               FontSize="16" />
                                                </Border>
                                            </Grid>
                                        </Border>
                                        <Border Background="Yellow"
                                                Width="70"
                                                Height="36"
                                                Margin="3"
                                                HorizontalAlignment="Left"
                                                VerticalAlignment="Top"
                                                CornerRadius="2">
                                            <Grid Background="White"
                                                  Margin="8,6">
                                                <Border BorderBrush="#DDD"
                                                        BorderThickness="1">

                                                    <TextBlock Text="18008"
                                                               Foreground="Black"
                                                               FontWeight="SemiBold"
                                                               HorizontalAlignment="Center"
                                                               FontSize="16" />
                                                </Border>
                                            </Grid>
                                        </Border>
                                        <Border Background="Blue"
                                                Width="70"
                                                Height="36"
                                                Margin="3"
                                                HorizontalAlignment="Left"
                                                VerticalAlignment="Top"
                                                CornerRadius="2">
                                            <Grid Background="White"
                                                  Margin="8,6">
                                                <Border BorderBrush="#DDD"
                                                        BorderThickness="1">

                                                    <TextBlock Text="18008"
                                                               Foreground="Black"
                                                               FontWeight="SemiBold"
                                                               HorizontalAlignment="Center"
                                                               FontSize="16" />
                                                </Border>
                                            </Grid>
                                        </Border>
                                        <Border Background="Blue"
                                                Width="70"
                                                Height="36"
                                                Margin="3"
                                                HorizontalAlignment="Left"
                                                VerticalAlignment="Top"
                                                CornerRadius="2">
                                            <Grid Background="White"
                                                  Margin="8,6">
                                                <Border BorderBrush="#DDD"
                                                        BorderThickness="1">

                                                    <TextBlock Text="18008"
                                                               Foreground="Black"
                                                               FontWeight="SemiBold"
                                                               HorizontalAlignment="Center"
                                                               FontSize="16" />
                                                </Border>
                                            </Grid>
                                        </Border>
                                        <Border Background="Blue"
                                                Width="70"
                                                Height="36"
                                                Margin="3"
                                                HorizontalAlignment="Left"
                                                VerticalAlignment="Top"
                                                CornerRadius="2">
                                            <Grid Background="White"
                                                  Margin="8,6">
                                                <Border BorderBrush="#DDD"
                                                        BorderThickness="1">

                                                    <TextBlock Text="18008"
                                                               Foreground="Black"
                                                               FontWeight="SemiBold"
                                                               HorizontalAlignment="Center"
                                                               FontSize="16" />
                                                </Border>
                                            </Grid>
                                        </Border>
                                        <Border Background="Blue"
                                                Width="70"
                                                Height="36"
                                                Margin="3"
                                                HorizontalAlignment="Left"
                                                VerticalAlignment="Top"
                                                CornerRadius="2">
                                            <Grid Background="White"
                                                  Margin="8,6">
                                                <Border BorderBrush="#DDD"
                                                        BorderThickness="1">

                                                    <TextBlock Text="18008"
                                                               Foreground="Black"
                                                               FontWeight="SemiBold"
                                                               HorizontalAlignment="Center"
                                                               FontSize="16" />
                                                </Border>
                                            </Grid>
                                        </Border>
                                        <Border Background="Blue"
                                                Width="70"
                                                Height="36"
                                                Margin="3"
                                                HorizontalAlignment="Left"
                                                VerticalAlignment="Top"
                                                CornerRadius="2">
                                            <Grid Background="White"
                                                  Margin="8,6">
                                                <Border BorderBrush="#DDD"
                                                        BorderThickness="1">

                                                    <TextBlock Text="18008"
                                                               Foreground="Black"
                                                               FontWeight="SemiBold"
                                                               HorizontalAlignment="Center"
                                                               FontSize="16" />
                                                </Border>
                                            </Grid>
                                        </Border>
                                        <Border Background="Blue"
                                                Width="70"
                                                Height="36"
                                                Margin="3"
                                                HorizontalAlignment="Left"
                                                VerticalAlignment="Top"
                                                CornerRadius="2">
                                            <Grid Background="White"
                                                  Margin="8,6">
                                                <Border BorderBrush="#DDD"
                                                        BorderThickness="1">

                                                    <TextBlock Text="18008"
                                                               Foreground="Black"
                                                               FontWeight="SemiBold"
                                                               HorizontalAlignment="Center"
                                                               FontSize="16" />
                                                </Border>
                                            </Grid>
                                        </Border>
                                        <Border Background="Blue"
                                                Width="70"
                                                Height="36"
                                                Margin="3"
                                                HorizontalAlignment="Left"
                                                VerticalAlignment="Top"
                                                CornerRadius="2">
                                            <Grid Background="White"
                                                  Margin="8,6">
                                                <Border BorderBrush="#DDD"
                                                        BorderThickness="1">

                                                    <TextBlock Text="18008"
                                                               Foreground="Black"
                                                               FontWeight="SemiBold"
                                                               HorizontalAlignment="Center"
                                                               FontSize="16" />
                                                </Border>
                                            </Grid>
                                        </Border>
                                        <Border Background="Purple"
                                                Width="70"
                                                Height="36"
                                                Margin="3"
                                                HorizontalAlignment="Left"
                                                VerticalAlignment="Top"
                                                CornerRadius="2">
                                            <Grid Background="White"
                                                  Margin="8,6">
                                                <Border BorderBrush="#DDD"
                                                        BorderThickness="1">

                                                    <TextBlock Text="18008"
                                                               Foreground="Black"
                                                               FontWeight="SemiBold"
                                                               HorizontalAlignment="Center"
                                                               FontSize="16" />
                                                </Border>
                                            </Grid>
                                        </Border>
                                        <Border Background="WhiteSmoke"
                                                Width="70"
                                                Height="36"
                                                Margin="3"
                                                HorizontalAlignment="Left"
                                                VerticalAlignment="Top"
                                                CornerRadius="2">
                                            <Grid Background="White"
                                                  Margin="8,6">
                                                <Border BorderBrush="#DDD"
                                                        BorderThickness="1">

                                                    <TextBlock Text="18008"
                                                               Foreground="Black"
                                                               FontWeight="SemiBold"
                                                               HorizontalAlignment="Center"
                                                               FontSize="16" />
                                                </Border>
                                            </Grid>
                                        </Border>
                                        <Border Background="Blue"
                                                Width="70"
                                                Height="36"
                                                Margin="3"
                                                HorizontalAlignment="Left"
                                                VerticalAlignment="Top"
                                                CornerRadius="2">
                                            <Grid Background="White"
                                                  Margin="8,6">
                                                <Border BorderBrush="#DDD"
                                                        BorderThickness="1">

                                                    <TextBlock Text="18008"
                                                               Foreground="Black"
                                                               FontWeight="SemiBold"
                                                               HorizontalAlignment="Center"
                                                               FontSize="16" />
                                                </Border>
                                            </Grid>
                                        </Border>
                                        <Border Background="Green"
                                                Width="70"
                                                Height="36"
                                                Margin="3"
                                                HorizontalAlignment="Left"
                                                VerticalAlignment="Top"
                                                CornerRadius="2">
                                            <Grid Background="White"
                                                  Margin="8,6">
                                                <Border BorderBrush="#DDD"
                                                        BorderThickness="1">

                                                    <TextBlock Text="18008"
                                                               Foreground="Black"
                                                               FontWeight="SemiBold"
                                                               HorizontalAlignment="Center"
                                                               FontSize="16" />
                                                </Border>
                                            </Grid>
                                        </Border>
                                    </WrapPanel>
                                </Border>

                                <!--#region GRAB A PAN-->
                                <Border Grid.Column="0"
                                        Grid.Row="0"
                                        Grid.ColumnSpan="2"
                                        Grid.RowSpan="4"
                                        Panel.ZIndex="100"
                                        Visibility="{Binding ShowingTakeANumberPanel}"
                                        d:Visibility="Hidden">
                                    <Border.Background>
                                        <SolidColorBrush Opacity="0.75"
                                                         Color="White" />
                                    </Border.Background>
                                    <Grid HorizontalAlignment="Center"
                                          VerticalAlignment="Center">
                                        <StackPanel>
                                            <core:OutlinedTextBlock Stroke="#000"
                                                                    StrokePosition="Outside"
                                                                    FontSize="180"
                                                                    HorizontalAlignment="Center"
                                                                    VerticalAlignment="Center"
                                                                    Text="{Binding PmNextPanNumberInList}"
                                                                    d:Text="8008"
                                                                    FontWeight="SemiBold"
                                                                    Fill="Yellow"
                                                                    StrokeThickness="1"
                                                                    Margin="0,2,8,0" />
                                            <Grid>
                                                <Grid.ColumnDefinitions>
                                                    <ColumnDefinition Width="160" />
                                                    <ColumnDefinition MinWidth="10" />
                                                    <ColumnDefinition Width="120" />
                                                </Grid.ColumnDefinitions>
                                                <Button Content="Take it"
                                                        Background="#C6F9CF"
                                                        Foreground="Black"
                                                        Height="40"
                                                        Command="{Binding TakeAPanNumberCommand}" />

                                                <Button Content="Cancel"
                                                        Background="#C6696F"
                                                        Grid.Column="2"
                                                        Command="{Binding PmCancelTakingANumberCommand}" />
                                            </Grid>
                                        </StackPanel>
                                    </Grid>
                                </Border>
                                <!--#endregion GRAB A PAN-->

                                <Grid Grid.Row="1"
                                      Margin="0,15">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition />
                                        <ColumnDefinition />
                                        <ColumnDefinition />
                                        <ColumnDefinition />
                                    </Grid.ColumnDefinitions>
                                    <Button Content="Grab a number"
                                            Background="#56795F"
                                            Grid.Column="0"
                                            Margin="0,0,5,0"
                                            IsEnabled="{Binding PmPanNumberList.Count, Converter={StaticResource ZeroToFalseConverter}}"
                                            Command="{Binding GrabAPanNumberCommand}" />
                                    <Button Content="Mark as RUSH"
                                            Background="#76595F"
                                            Grid.Column="1"
                                            Margin="5,0,5,0"
                                            Visibility="{Binding PmRushButtonShows}"
                                            d:Visibility="Visible"
                                            Command="{Binding PmMarkCaseAsRushCommand}" />
                                    <Button Content="Add Send To line"
                                            Background="#96995F"
                                            Grid.Column="2"
                                            Margin="5,0,5,0"
                                            Command="{Binding PmAddSendToLabelCommand}"
                                            Visibility="{Binding PmSendToButtonShows}"
                                            d:Visibility="Visible" />
                                    <ComboBox Grid.Column="3"
                                              ItemsSource="{Binding PmSendToList}"
                                              SelectedItem="{Binding PmSelectedSentTo}"
                                              Visibility="{Binding PmSendToButtonShows}"
                                              d:Visibility="Visible" />
                                </Grid>

                                <Grid Grid.Row="2">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="auto" />
                                        <ColumnDefinition />
                                    </Grid.ColumnDefinitions>
                                    <StackPanel HorizontalAlignment="Left">
                                        <TextBlock Text="Available Pan Numbers" />
                                        <TextBlock Text="{Binding PmPanNumberList.Count, UpdateSourceTrigger=PropertyChanged }"
                                                   d:Text="13"
                                                   HorizontalAlignment="Center"
                                                   FontSize="50"
                                                   Margin="0,-6,0,0" />
                                    </StackPanel>

                                    <StackPanel Grid.Column="1"
                                                Margin="42,0,0,0"
                                                VerticalAlignment="Top">
                                        <TextBlock Text="Add new number:"
                                                   Margin="2,0,0,0" />
                                        <TextBox Text="{Binding PmAddNewNumber, UpdateSourceTrigger=PropertyChanged}"
                                                 Width="130"
                                                 HorizontalAlignment="Left"
                                                 FontSize="15"
                                                 Background="#555"
                                                 Foreground="Beige"
                                                 Margin="2,0,0,2">
                                            <TextBox.InputBindings>
                                                <KeyBinding Key="Enter"
                                                            Command="{Binding PmAddNewPanNumberCommand}"
                                                            CommandParameter="{Binding PmAddNewNumber}" />
                                            </TextBox.InputBindings>
                                        </TextBox>
                                        <Grid>
                                            <Grid.RowDefinitions>
                                                <RowDefinition />
                                                <RowDefinition />
                                            </Grid.RowDefinitions>
                                            <CheckBox Content="Open up saved prescriptions in MS Edge"
                                                      Foreground="LightGreen"
                                                      HorizontalAlignment="Left"
                                                      Margin="0,0,-180,0"
                                                      Grid.Row="0"
                                                      IsChecked="{Binding PmOpenUpPrescriptionsBool}"
                                                      Style="{StaticResource CircleCheckBox}"
                                                      Command="{Binding PmOpenUpPrescriptionsCommand}" />
                                            <CheckBox Content="Open up Sirona Scan Folder after processing.."
                                                      Foreground="Yellow"
                                                      HorizontalAlignment="Left"
                                                      Margin="0,0,-350,0"
                                                      Grid.Row="1"
                                                      IsChecked="{Binding CbSettingOpenUpSironaScanFolder, Mode=TwoWay}"
                                                      Style="{StaticResource CircleCheckBox}"
                                                      Command="{Binding CbSettingOpenUpSironaScanFolderCommand}" />
                                        </Grid>

                                    </StackPanel>

                                </Grid>

                                <Grid Grid.Row="3">
                                    <StackPanel Orientation="Horizontal">

                                        <StackPanel HorizontalAlignment="Left"
                                                    VerticalAlignment="Bottom"
                                                    Margin="0,0,20,0"
                                                    Visibility="{Binding LastIteroZipFileId, Converter={StaticResource EmptyToCollapsedConverter}}"
                                                    d:Visibility="Visible">
                                            <TextBlock Text="{Binding LastIteroZipFileId, UpdateSourceTrigger=PropertyChanged }"
                                                       d:Text="164106600"
                                                       HorizontalAlignment="Center"
                                                       FontSize="20"
                                                       Foreground="LightGreen"
                                                       Margin="0,-6,0,0" />
                                            <TextBlock Text="Last iTero Zip file ID"
                                                       FontSize="11" />
                                        </StackPanel>

                                        <StackPanel HorizontalAlignment="Right"
                                                    VerticalAlignment="Bottom"
                                                    Visibility="{Binding PmLastTakenPanNumber, Converter={StaticResource EmptyToCollapsedConverter}}"
                                                    d:Visibility="Visible">
                                            <TextBlock Text="{Binding PmLastTakenPanNumber}"
                                                       d:Text="145"
                                                       HorizontalAlignment="Center"
                                                       FontSize="20"
                                                       Foreground="Yellow"
                                                       Margin="0,0,0,0" />
                                            <TextBlock Text="Last grabbed number"
                                                       FontSize="11" />
                                        </StackPanel>
                                    </StackPanel>
                                </Grid>

                                <StackPanel Grid.Column="1"
                                            Grid.Row="3"
                                            VerticalAlignment="Bottom"
                                            HorizontalAlignment="Right"
                                            Visibility="{Binding PdfPageCount, Converter={StaticResource EmptyToHiddenConverter}}"
                                            d:Visibility="Visible"
                                            Margin="0,0,0,0">
                                    <TextBlock Text="{Binding PdfPageCount}"
                                               d:Text="2"
                                               FontSize="30"
                                               HorizontalAlignment="Center"
                                               FontWeight="Thin" />
                                    <TextBlock Text="PAGES"
                                               FontSize="10"
                                               FontWeight="Thin" />

                                </StackPanel>

                                <Image Source="{Binding PmSavedPrescription}"
                                       Grid.Column="1"
                                       Grid.Row="0"
                                       Grid.RowSpan="4" />

                                <ProgressBar Grid.Column="1"
                                             Grid.Row="0"
                                             Height="5"
                                             Width="170"
                                             VerticalAlignment="Center"
                                             IsIndeterminate="True"
                                             Visibility="{Binding ProcessingDigiPrescriptionNow}"
                                             d:Visibility="Visible"
                                             Margin="0,58,0,0" />
                                <TextBlock Text="Processing.."
                                           Grid.Column="1"
                                           Grid.Row="0"
                                           HorizontalAlignment="Center"
                                           VerticalAlignment="Center"
                                           FontSize="30"
                                           FontWeight="Thin"
                                           Visibility="{Binding ProcessingDigiPrescriptionNow}"
                                           d:Visibility="Visible" />
                                <TextBlock Text="Please wait!"
                                           Grid.Column="1"
                                           Grid.Row="0"
                                           HorizontalAlignment="Center"
                                           VerticalAlignment="Center"
                                           FontSize="10"
                                           Margin="0,82,0,0"
                                           FontWeight="Thin"
                                           Visibility="{Binding ProcessingDigiPrescriptionNow}"
                                           d:Visibility="Visible" />
                            </Grid>
                        </TabItem>

                        <TabItem Header="Pending Digitals"
                                 x:Name="pendingDigiCasesTab"
                                 IsTabStop="False"
                                 Visibility="{Binding CbSettingModulePendingDigitals, Converter={StaticResource BoolToVisibilityConverter}}"
                                 d:Visibility="Visible"
                                 Style="{StaticResource applicationsTabItem}">
                            <Grid Margin="5">
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="auto" />
                                    <RowDefinition />
                                    <RowDefinition Height="auto" />
                                    <RowDefinition Height="auto" />
                                </Grid.RowDefinitions>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="110" />
                                    <ColumnDefinition />
                                </Grid.ColumnDefinitions>

                                <StackPanel Grid.Row="0"
                                            Grid.Column="0"
                                            Grid.ColumnSpan="2"
                                            Visibility="{Binding CbSettingModulePendingDigitals, Converter={StaticResource BoolToVisibilityConverter}}"
                                            d:Visibility="Visible">
                                    <StackPanel Orientation="Horizontal">
                                        <TextBlock Text="{Binding PendingDigiCasesReplacementName}"
                                                   d:Text="Pending Digitals"
                                                   FontSize="20"
                                                   FontWeight="Thin" />
                                        <TextBlock Text="from CasePoster (In-House)"
                                                   FontSize="12"
                                                   Foreground="#c2effc"
                                                   FontWeight="Thin"
                                                   VerticalAlignment="Center"
                                                   Margin="6,3,0,0" />
                                    </StackPanel>
                                </StackPanel>



                                <Grid Grid.Row="1"
                                      Grid.Column="0"
                                      Visibility="{Binding CbSettingModulePendingDigitals, Converter={StaticResource BoolToVisibilityConverter}}"
                                      d:Visibility="Visible">
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="35" />
                                        <RowDefinition />
                                    </Grid.RowDefinitions>

                                    <TextBlock Text="Waiting for collect"
                                               FontSize="14"
                                               FontWeight="Thin"
                                               Margin="0,10,0,0" />

                                    <ListView Grid.Row="1"
                                              Background="#666"
                                              Foreground="Beige"
                                              FontSize="14"
                                              BorderThickness="1"
                                              ItemsSource="{Binding PendingDigiNumbersWaitingToCollect}" />
                                </Grid>

                                <Grid Grid.Row="1"
                                      Grid.Column="1"
                                      Margin="20,0,0,0"
                                      Visibility="{Binding CbSettingModulePendingDigitals, Converter={StaticResource BoolToVisibilityConverter}}"
                                      d:Visibility="Visible">

                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="35" />
                                        <RowDefinition />
                                    </Grid.RowDefinitions>

                                    <TextBlock Text="All times numbers in detail"
                                               FontSize="14"
                                               Grid.Column="2"
                                               FontWeight="Thin"
                                               Margin="0,10,0,0" />

                                    <Border BorderThickness="1"
                                            BorderBrush="#BBB"
                                            Grid.Row="1"
                                            Grid.Column="2"
                                            Grid.ColumnSpan="2">

                                        <ListView Background="#666"
                                                  Foreground="Beige"
                                                  FontSize="12"
                                                  BorderThickness="0"
                                                  ItemsSource="{Binding PendingDigiNumbersWaitingToProcess}"
                                                  ItemContainerStyle="{StaticResource LvItemPendingDigitalCases}"
                                                  AlternationCount="2">


                                            <ListView.View>

                                                <GridView AllowsColumnReorder="False">
                                                    <GridView.ColumnHeaderContainerStyle>
                                                        <Style TargetType="{x:Type GridViewColumnHeader}">
                                                            <Setter Property="Foreground"
                                                                    Value="Black" />
                                                            <Setter Property="Background"
                                                                    Value="#888" />
                                                            <Setter Property="BorderBrush"
                                                                    Value="#888" />
                                                            <Setter Property="FontWeight"
                                                                    Value="Normal" />
                                                            <Style.Triggers>
                                                                <Trigger Property="IsMouseOver"
                                                                         Value="True">
                                                                    <Setter Property="Foreground"
                                                                            Value="Black" />
                                                                    <Setter Property="Background"
                                                                            Value="#DDD" />
                                                                </Trigger>
                                                            </Style.Triggers>
                                                        </Style>
                                                    </GridView.ColumnHeaderContainerStyle>
                                                    <GridViewColumn x:Name="pdPanNumber"
                                                                    Width="50"
                                                                    DisplayMemberBinding="{Binding PanNumber}">
                                                        <GridViewColumn.Header>
                                                            <GridViewColumnHeader Template="{StaticResource CustomHeaderPendingDigi}"
                                                                                  Tag="  Pan Nr" />
                                                        </GridViewColumn.Header>
                                                    </GridViewColumn>

                                                    <GridViewColumn x:Name="pdIsCollected"
                                                                    Width="60"
                                                                    DisplayMemberBinding="{Binding IsCollected}">
                                                        <GridViewColumn.Header>
                                                            <GridViewColumnHeader Template="{StaticResource CustomHeaderPendingDigi}"
                                                                                  Tag="  Collected" />
                                                        </GridViewColumn.Header>
                                                    </GridViewColumn>
                                                    <GridViewColumn x:Name="pdIsProcessed"
                                                                    Width="62"
                                                                    DisplayMemberBinding="{Binding IsProcessed}">
                                                        <GridViewColumn.Header>
                                                            <GridViewColumnHeader Template="{StaticResource CustomHeaderPendingDigi}"
                                                                                  Tag="  Processed" />
                                                        </GridViewColumn.Header>
                                                    </GridViewColumn>

                                                    <GridViewColumn x:Name="pbProcessedBy"
                                                                    Width="120"
                                                                    DisplayMemberBinding="{Binding ProcessedBy}">
                                                        <GridViewColumn.Header>
                                                            <GridViewColumnHeader Template="{StaticResource CustomHeaderPendingDigi}"
                                                                                  Tag="  Processed By" />
                                                        </GridViewColumn.Header>
                                                    </GridViewColumn>



                                                    <GridViewColumn x:Name="pbProcessedTime"
                                                                    Width="120"
                                                                    DisplayMemberBinding="{Binding ProcessedTime}">
                                                        <GridViewColumn.Header>
                                                            <GridViewColumnHeader Template="{StaticResource CustomHeaderPendingDigi}"
                                                                                  Tag="  Processed Time" />
                                                        </GridViewColumn.Header>
                                                    </GridViewColumn>

                                                    <GridViewColumn x:Name="pbPostedBy"
                                                                    Width="120"
                                                                    DisplayMemberBinding="{Binding PostedBy}">
                                                        <GridViewColumn.Header>
                                                            <GridViewColumnHeader Template="{StaticResource CustomHeaderPendingDigi}"
                                                                                  Tag="  Posted By" />
                                                        </GridViewColumn.Header>
                                                    </GridViewColumn>

                                                    <GridViewColumn x:Name="pbPostedTime"
                                                                    Width="120"
                                                                    DisplayMemberBinding="{Binding PostedTime}">
                                                        <GridViewColumn.Header>
                                                            <GridViewColumnHeader Template="{StaticResource CustomHeaderPendingDigi}"
                                                                                  Tag="  Posted Time" />
                                                        </GridViewColumn.Header>
                                                    </GridViewColumn>



                                                </GridView>

                                            </ListView.View>
                                        </ListView>
                                    </Border>

                                </Grid>

                                <StackPanel Grid.Row="2"
                                            Grid.Column="0"
                                            Margin="0,20,0,6"
                                            Grid.ColumnSpan="2"
                                            Visibility="{Binding TotalNewDigiCaseWithoutInHouseCases, Converter={StaticResource ZeroToCollapsedConverter}}"
                                            d:Visibility="Visible">
                                    <StackPanel Orientation="Horizontal">
                                        <TextBlock Text="Pending Digitals"
                                                   FontSize="20"
                                                   FontWeight="Thin" />
                                        <TextBlock Text="from Dental Offices"
                                                   FontSize="12"
                                                   Foreground="LightGreen"
                                                   FontWeight="Thin"
                                                   VerticalAlignment="Center"
                                                   Margin="6,3,0,0" />
                                    </StackPanel>

                                </StackPanel>

                                <ScrollViewer Grid.Row="3"
                                              Grid.Column="0"
                                              Grid.ColumnSpan="2"
                                              VerticalAlignment="Top"
                                              HorizontalAlignment="Left"
                                              VerticalScrollBarVisibility="Visible"
                                              HorizontalScrollBarVisibility="Disabled"
                                              CanContentScroll="True"
                                              ClipToBounds="True">

                                    <StackPanel x:Name="panelNewlyArrivedDigitalCasesList"
                                                VerticalAlignment="Top" />
                                </ScrollViewer>
                            </Grid>
                        </TabItem>

                        <TabItem Header="Smart Order Names"
                                 IsTabStop="False"
                                 Visibility="{Binding CbSettingModuleSmartOrderNames, Converter={StaticResource BoolToVisibilityConverter}}"
                                 d:Visibility="Visible"
                                 Style="{StaticResource applicationsTabItem}">
                            <localView:SmartOrderNamesPage DataContext="{Binding SmartOrderNamesViewModel}"
                                                           Margin="-1,1,-1,0" />
                        </TabItem>

                        <TabItem IsTabStop="False"
                                 x:Name="orderIssuesTab"
                                 Visibility="{Binding SentOutIssuesCount, Converter={StaticResource ZeroToCollapsedConverter}}"
                                 d:Visibility="Visible"
                                 Style="{StaticResource applicationsTabItem}">
                            <TabItem.Header>
                                <StackPanel Orientation="Horizontal">
                                    <TextBlock Text="Order Issues" />
                                    <TextBlock Text="{Binding SentOutIssuesCount, StringFormat='- \{0}'}"
                                               Margin="4,0,0,0" />
                                </StackPanel>
                            </TabItem.Header>
                            <Grid>
                                <TextBlock Text="Nothing here yet.."
                                           VerticalAlignment="Center"
                                           HorizontalAlignment="Center"
                                           Foreground="#999"
                                           d:Visibility="Visible"
                                           Visibility="{Binding SentOutIssuesCount, Converter={StaticResource ZeroToCollapsedVisibilityConverter}}" />
                                <ListView ItemsSource="{Binding OrderIssuesList}"
                                          ItemContainerStyle="{StaticResource LvItemIssues}"
                                          SelectedItem="{Binding SelectedOrderIssue}"
                                          Background="#46494F"
                                          BorderThickness="0"
                                          ScrollViewer.HorizontalScrollBarVisibility="Hidden">
                                    <ListView.View>
                                        <GridView AllowsColumnReorder="False"
                                                  ColumnHeaderContainerStyle="{StaticResource HiddenHeaderStyle}">
                                            <GridViewColumn x:Name="lvIssuesOrderID" />
                                            <GridViewColumn x:Name="lvIssuesSkipReason" />
                                        </GridView>
                                    </ListView.View>
                                </ListView>
                            </Grid>
                        </TabItem>


                    </TabControl>
                </TabItem>
                <!--#endregion APPLICATIONS TAB -->










                <!--#region INFO TAB -->
                <TabItem HorizontalAlignment="Right"
                         DockPanel.Dock="Right"
                         x:Name="infoTab"
                         IsTabStop="False">
                    <TabItem.Header>
                        <StackPanel Orientation="Horizontal">
                            <TextBlock Text="Info" />
                        </StackPanel>
                    </TabItem.Header>

                    <TabControl BorderThickness="0"
                                d:TabStripPlacement="Top"
                                x:Name="infoTabControl"
                                Style="{StaticResource hiddenTabsTabControl}"
                                Grid.Row="1">
                        <TabControl.Background>
                            <ImageBrush x:Name="image"
                                        Stretch="UniformToFill"
                                        ImageSource="/Images/avatar_pink.jpeg"
                                        Opacity="0.05" />
                        </TabControl.Background>

                        <TabItem Header="Info"
                                 x:Name="aboutTab"
                                 d:Visibility="Visible"
                                 Visibility="Hidden">
                            <Grid Margin="20,10">
                                <StackPanel Panel.ZIndex="10">
                                    <TextBlock Text="Stats Client 2025"
                                               FontSize="26"
                                               FontWeight="Thin" />

                                    <Grid Width="300"
                                          Margin="0,10,0,0"
                                          HorizontalAlignment="Left">

                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition />
                                            <ColumnDefinition />
                                        </Grid.ColumnDefinitions>

                                        <Grid.RowDefinitions>
                                            <RowDefinition Height="auto" />
                                            <RowDefinition Height="16" />
                                            <RowDefinition Height="auto" />
                                            <RowDefinition Height="auto" />
                                            <RowDefinition Height="auto" />
                                            <RowDefinition Height="auto" />
                                        </Grid.RowDefinitions>

                                        <TextBlock Text="Current app version:"
                                                   FontSize="12"
                                                   Margin="2,0,0,0" />
                                        <TextBlock Text="{Binding SoftwareVersion, StringFormat='v\{0}'}"
                                                   d:Text="v1"
                                                   FontSize="12"
                                                   Grid.Column="1"
                                                   Foreground="Yellow"
                                                   Margin="5,0,0,0" />



                                        <TextBlock Text="Latest version online:"
                                                   FontSize="12"
                                                   Grid.Row="1"
                                                   d:Visibility="Visible"
                                                   Visibility="{Binding UpdateAvailable, Converter={StaticResource BoolToVisibilityConverter}}"
                                                   Margin="2,0,0,0" />
                                        <TextBlock Text="{Binding LatestAppVersion, StringFormat='v\{0}'}"
                                                   d:Text="v2"
                                                   FontSize="12"
                                                   d:Visibility="Visible"
                                                   Visibility="{Binding UpdateAvailable, Converter={StaticResource BoolToVisibilityConverter}}"
                                                   Grid.Row="1"
                                                   Grid.Column="1"
                                                   Foreground="Orange"
                                                   Margin="5,0,0,0" />

                                        <TextBlock Text="Total System Memory:"
                                                   FontSize="12"
                                                   Grid.Row="2"
                                                   Margin="2,10,0,0" />
                                        <TextBlock Text="{Binding TotalMemoryInGiB, StringFormat='\{0} GiB'}"
                                                   d:Text="350 MB"
                                                   FontSize="12"
                                                   Grid.Row="2"
                                                   Grid.Column="1"
                                                   Foreground="Beige"
                                                   Margin="5,10,0,0" />

                                        <TextBlock Text="App's memory usage:"
                                                   FontSize="12"
                                                   Grid.Row="3"
                                                   Margin="2,0,0,0" />
                                        <TextBlock Text="{Binding CurrentMemoryUsage, StringFormat='\{0} MiB'}"
                                                   d:Text="350 MB"
                                                   FontSize="12"
                                                   Grid.Row="3"
                                                   Grid.Column="1"
                                                   Foreground="LightGreen"
                                                   Margin="5,0,0,0" />
                                        
                                        <TextBlock Text="3Shape Search limit set:"
                                                   FontSize="12"
                                                   Grid.Row="4"
                                                   Margin="2,10,0,0" />
                                        <TextBlock Text="{Binding SearchLimit}"
                                                   d:Text="200"
                                                   FontSize="12"
                                                   Grid.Row="4"
                                                   Grid.Column="1"
                                                   Foreground="White"
                                                   Margin="5,10,0,0" />



                                        <Button Content="Go to settings"
                                                Grid.Row="5"
                                                Height="24"
                                                Margin="0,30,0,0"
                                                Click="SettingsButton_Click" />
                                    </Grid>
                                </StackPanel>

                            </Grid>

                        </TabItem>
                        <TabItem Header="Settings"
                                 x:Name="settingsTab"
                                 Background="#66696F"
                                 d:Visibility="Visible"
                                 Visibility="Hidden">
                            <Grid Background="#484C4F">

                                <TabControl Grid.Row="1"
                                            Background="#66696F"
                                            BorderThickness="1,1,1,1"
                                            Margin="15"
                                            x:Name="settingsTabControl"
                                            Style="{StaticResource applicationsTabControl}"
                                            TabStripPlacement="Left">


                                    <TabItem Header="General"
                                             Style="{StaticResource applicationsTabItem}">
                                        <Grid Margin="10,0">
                                            <StackPanel Grid.Row="0">
                                                <DockPanel>
                                                    <TextBlock Text="General"
                                                               FontSize="26"
                                                               FontWeight="Thin" />
                                                </DockPanel>


                                                <CheckBox Content="Use glassy effect on window"
                                                          Foreground="Beige"
                                                          VerticalAlignment="Top"
                                                          HorizontalAlignment="Left"
                                                          Cursor="Hand"
                                                          IsChecked="{Binding CbSettingGlassyEffect, Mode=TwoWay}"
                                                          Style="{StaticResource CircleCheckBox}"
                                                          Command="{Binding CbSettingGlassyEffectCommand}"
                                                          Margin="0,6,5,0" />

                                                <StackPanel Orientation="Horizontal">
                                                    <CheckBox Content="Start app minimized"
                                                              Foreground="Beige"
                                                              VerticalAlignment="Top"
                                                              HorizontalAlignment="Left"
                                                              Cursor="Hand"
                                                              IsChecked="{Binding CbSettingStartAppMinimized, Mode=TwoWay}"
                                                              Style="{StaticResource CircleCheckBox}"
                                                              Command="{Binding CbSettingStartAppMinimizedCommand}"
                                                              Margin="0,6,5,0" />

                                                    <TextBlock Text="(for Pan Color Check only)"
                                                               Foreground="#BBB"
                                                               FontSize="10"
                                                               VerticalAlignment="Center"
                                                               Margin="0,6,0,0" />
                                                </StackPanel>

                                                <CheckBox Content="Use Pan Color Check window as a snapped window"
                                                          Foreground="Beige"
                                                          VerticalAlignment="Top"
                                                          HorizontalAlignment="Left"
                                                          Cursor="Hand"
                                                          IsChecked="{Binding CbSettingPanColorCheckWndwIsSnapped, Mode=TwoWay}"
                                                          Style="{StaticResource CircleCheckBox}"
                                                          Command="{Binding CbSettingPanColorCheckWndwIsSnappedCommand}"
                                                          Margin="0,6,5,0" />

                                                <StackPanel Orientation="Horizontal"
                                                            Margin="6,10,0,0">
                                                    <TextBlock Text="Search limit in 3Shape" 
                                                               VerticalAlignment="Center"
                                                               />
                                                    <ComboBox Width="72"
                                                              Margin="4,0"
                                                              HorizontalContentAlignment="Center"
                                                              ItemsSource="{Binding SearchLimits}"
                                                              SelectedItem="{Binding SearchLimit}">
                                                        <i:Interaction.Triggers>
                                                            <i:EventTrigger EventName="SelectionChanged">
                                                                <i:InvokeCommandAction Command="{Binding SearchLimitSelectionChangedCommand}" />
                                                            </i:EventTrigger>
                                                        </i:Interaction.Triggers>
                                                    </ComboBox>
                                                </StackPanel>
                                            </StackPanel>
                                        </Grid>
                                    </TabItem>

                                    <TabItem Header="Modules"
                                             Style="{StaticResource applicationsTabItem}">
                                        <Grid Margin="10,0">
                                            <StackPanel Grid.Row="0">

                                                <TextBlock Text="Modules"
                                                           FontSize="26"
                                                           FontWeight="Thin" />

                                                <CheckBox Content="Account Infos"
                                                          Foreground="Beige"
                                                          VerticalAlignment="Top"
                                                          HorizontalAlignment="Left"
                                                          Cursor="Hand"
                                                          IsChecked="{Binding CbSettingModuleAccountInfos, Mode=TwoWay}"
                                                          Style="{StaticResource CircleCheckBox}"
                                                          Command="{Binding CbSettingModuleAccountInfosCommand}"
                                                          Margin="0,6,5,0" />

                                                <CheckBox Content="Folder Subscription"
                                                          Foreground="Beige"
                                                          VerticalAlignment="Top"
                                                          HorizontalAlignment="Left"
                                                          Cursor="Hand"
                                                          IsChecked="{Binding CbSettingModuleFolderSubscription, Mode=TwoWay}"
                                                          Style="{StaticResource CircleCheckBox}"
                                                          Command="{Binding CbSettingModuleFolderSubscriptionCommand}"
                                                          Margin="0,6,5,0" />

                                                <CheckBox Content="Prescription Maker"
                                                          Foreground="Beige"
                                                          VerticalAlignment="Top"
                                                          HorizontalAlignment="Left"
                                                          Cursor="Hand"
                                                          IsChecked="{Binding CbSettingModulePrescriptionMaker, Mode=TwoWay}"
                                                          Style="{StaticResource CircleCheckBox}"
                                                          Command="{Binding CbSettingModulePrescriptionMakerCommand}"
                                                          Margin="0,6,5,0" />

                                                <CheckBox Content="Pending Digitals"
                                                          Foreground="Beige"
                                                          VerticalAlignment="Top"
                                                          HorizontalAlignment="Left"
                                                          Cursor="Hand"
                                                          IsChecked="{Binding CbSettingModulePendingDigitals, Mode=TwoWay}"
                                                          Style="{StaticResource CircleCheckBox}"
                                                          Command="{Binding CbSettingModulePendingDigitalsCommand}"
                                                          Margin="0,6,5,0" />

                                                <CheckBox Content="Smart Order Names"
                                                          Foreground="Beige"
                                                          VerticalAlignment="Top"
                                                          HorizontalAlignment="Left"
                                                          Cursor="Hand"
                                                          IsChecked="{Binding CbSettingModuleSmartOrderNames, Mode=TwoWay}"
                                                          Style="{StaticResource CircleCheckBox}"
                                                          Command="{Binding CbSettingModuleSmartOrderNamesCommand}"
                                                          Margin="0,6,5,0" />

                                                <CheckBox Content="Debug"
                                                          Foreground="MistyRose"
                                                          VerticalAlignment="Top"
                                                          HorizontalAlignment="Left"
                                                          Cursor="Hand"
                                                          IsChecked="{Binding CbSettingModuleDebug, Mode=TwoWay}"
                                                          Style="{StaticResource CircleCheckBox}"
                                                          Command="{Binding CbSettingModuleDebugCommand}"
                                                          Margin="0,6,5,0" />

                                            </StackPanel>
                                        </Grid>
                                    </TabItem>

                                    <TabItem Header="Debug"
                                             Visibility="{Binding CbSettingModuleDebug, Converter={StaticResource BoolToVisibilityConverter}}"
                                             d:Visibility="Visible"
                                             x:Name="debugTab"
                                             Style="{StaticResource applicationsTabItem}">
                                        <Grid>
                                            <TextBlock Text="Messages"
                                                       FontSize="26"
                                                       Margin="10,0,0,0"
                                                       FontWeight="Thin" />
                                            <ListView ItemsSource="{Binding DebugMessages}"
                                                      Background="Transparent"
                                                      Padding="6"
                                                      ScrollViewer.HorizontalScrollBarVisibility="Hidden"
                                                      Margin="0,38,0,0"
                                                      IsTabStop="True"
                                                      BorderThickness="0"
                                                      x:Name="debugMessageListView"
                                                      Foreground="Beige">
                                                <ListView.View>
                                                    <GridView AllowsColumnReorder="False"
                                                              ColumnHeaderContainerStyle="{StaticResource HiddenHeaderStyle}">
                                                        <GridViewColumn Width="80"
                                                                        DisplayMemberBinding="{Binding DTime}" />
                                                        <GridViewColumn Width="60"
                                                                        DisplayMemberBinding="{Binding DLineNumber}" />
                                                        <GridViewColumn Width="60"
                                                                        DisplayMemberBinding="{Binding DLocation}" />
                                                        <GridViewColumn Width="4000"
                                                                        DisplayMemberBinding="{Binding DMessage}" />
                                                    </GridView>
                                                </ListView.View>

                                                <ListView.ItemContainerStyle>
                                                    <Style TargetType="{x:Type ListViewItem}">
                                                        <Setter Property="Background"
                                                                Value="Transparent" />
                                                        <Setter Property="Template">
                                                            <Setter.Value>
                                                                <ControlTemplate TargetType="{x:Type ListViewItem}">
                                                                    <Border BorderBrush="Transparent"
                                                                            BorderThickness="0"
                                                                            Background="{TemplateBinding Background}">
                                                                        <GridViewRowPresenter HorizontalAlignment="Stretch"
                                                                                              VerticalAlignment="{TemplateBinding VerticalContentAlignment}"
                                                                                              Width="Auto"
                                                                                              Margin="0"
                                                                                              Content="{TemplateBinding Content}" />
                                                                    </Border>
                                                                </ControlTemplate>
                                                            </Setter.Value>
                                                        </Setter>
                                                    </Style>
                                                </ListView.ItemContainerStyle>
                                            </ListView>
                                        </Grid>
                                    </TabItem>

                                    <TabItem Header="Infos / Views"
                                             Style="{StaticResource applicationsTabItem}">
                                        <Grid Margin="10,0">
                                            <StackPanel Grid.Row="1"
                                                        Margin="0,0,0,0">
                                                <TextBlock Text="Infos"
                                                           FontSize="26"
                                                           FontWeight="Thin" />

                                                <CheckBox Content="Show bottom info bar"
                                                          Foreground="Azure"
                                                          VerticalAlignment="Top"
                                                          HorizontalAlignment="Left"
                                                          Cursor="Hand"
                                                          IsChecked="{Binding ShowBottomInfoBar, Mode=TwoWay}"
                                                          Style="{StaticResource CircleCheckBox}"
                                                          Command="{Binding CbSettingShowBottomInfoBarCommand}"
                                                          Margin="0,6,5,0" />

                                                <CheckBox Content="Show newly arrived digital cases count"
                                                          Foreground="MintCream"
                                                          VerticalAlignment="Top"
                                                          HorizontalAlignment="Left"
                                                          Cursor="Hand"
                                                          IsChecked="{Binding CbSettingShowDigiCases, Mode=TwoWay}"
                                                          Style="{StaticResource CircleCheckBox}"
                                                          Command="{Binding CbSettingShowDigiCasesCommand}"
                                                          Visibility="{Binding CbSettingModulePendingDigitals, Converter={StaticResource BoolToVisibilityConverter}}"
                                                          d:Visibility="Visible"
                                                          Margin="0,6,5,0" />

                                                <Grid Visibility="{Binding CbSettingModulePendingDigitals, Converter={StaticResource BoolToVisibilityConverter}}"
                                                      d:Visibility="Visible">

                                                    <CheckBox Content="Show detailed info of arrived digi cases"
                                                              Foreground="MintCream"
                                                              VerticalAlignment="Top"
                                                              HorizontalAlignment="Left"
                                                              Cursor="Hand"
                                                              IsChecked="{Binding CbSettingShowDigiDetails, Mode=TwoWay}"
                                                              Style="{StaticResource CircleCheckBox}"
                                                              Command="{Binding CbSettingShowDigiDetailsCommand}"
                                                              Visibility="{Binding ShowBottomInfoBar, Converter={StaticResource BoolToVisibilityConverter}}"
                                                              d:Visibility="Visible"
                                                              Margin="0,6,5,0" />
                                                </Grid>

                                                <CheckBox Content="Show waiting for collect 'Pending Digi' cases coming from CasePoster"
                                                          Foreground="#8ce4ff"
                                                          VerticalAlignment="Top"
                                                          HorizontalAlignment="Left"
                                                          Cursor="Hand"
                                                          IsChecked="{Binding CbSettingShowPendingDigiCases, Mode=TwoWay}"
                                                          Style="{StaticResource CircleCheckBox}"
                                                          Command="{Binding CbSettingShowPendingDigiCasesCommand}"
                                                          Visibility="{Binding CbSettingModuleFolderSubscription, Converter={StaticResource BoolToVisibilityConverter}}"
                                                          d:Visibility="Visible"
                                                          Margin="0,6,5,0" />

                                                <CheckBox Content="Include 'Pending Digi' cases in newly arrived digital cases"
                                                          Foreground="MintCream"
                                                          VerticalAlignment="Top"
                                                          HorizontalAlignment="Left"
                                                          Cursor="Hand"
                                                          IsChecked="{Binding CbSettingIncludePendingDigiCasesInNewlyArrived, Mode=TwoWay}"
                                                          Style="{StaticResource CircleCheckBox}"
                                                          Command="{Binding CbSettingIncludePendingDigiCasesInNewlyArrivedCommand}"
                                                          Margin="0,6,5,0" />
                                                <StackPanel Orientation="Horizontal"
                                                            Margin="19,5,0,0">
                                                    <TextBlock Text="Rename 'PendingDigi' to:" />
                                                    <TextBox Margin="10,0,0,0"
                                                             Width="150"
                                                             Text="{Binding PendingDigiCasesReplacementName}"
                                                             Foreground="Beige"
                                                             Background="#777"
                                                             BorderBrush="Beige" />
                                                </StackPanel>

                                                <CheckBox Content="Show empty pan count on infobar"
                                                          Foreground="#85ffce"
                                                          VerticalAlignment="Top"
                                                          HorizontalAlignment="Left"
                                                          Cursor="Hand"
                                                          IsChecked="{Binding CbSettingShowEmptyPanCount, Mode=TwoWay}"
                                                          Style="{StaticResource CircleCheckBox}"
                                                          Command="{Binding CbSettingShowEmptyPanCountCommand}"
                                                          Margin="0,26,5,0" />

                                                <CheckBox Content="Show digi prescriptions count from Today on infobar"
                                                          Foreground="#fad282"
                                                          VerticalAlignment="Top"
                                                          HorizontalAlignment="Left"
                                                          Cursor="Hand"
                                                          IsChecked="{Binding CbSettingShowDigiPrescriptionsCount, Mode=TwoWay}"
                                                          Style="{StaticResource CircleCheckBox}"
                                                          Command="{Binding CbSettingShowDigiPrescriptionsCountCommand}"
                                                          Margin="0,6,5,0" />

                                                <CheckBox Content="Show digi cases count in 3Shape Today on infobar"
                                                          Foreground="#f8fa82"
                                                          VerticalAlignment="Top"
                                                          HorizontalAlignment="Left"
                                                          Cursor="Hand"
                                                          IsChecked="{Binding CbSettingShowDigiCasesIn3ShapeTodayCount, Mode=TwoWay}"
                                                          Style="{StaticResource CircleCheckBox}"
                                                          Command="{Binding CbSettingShowDigiCasesIn3ShapeTodayCountCommand}"
                                                          Margin="0,6,5,0" />

                                            </StackPanel>

                                        </Grid>
                                    </TabItem>

                                    <TabItem Header="Prescription Maker"
                                             Visibility="{Binding CbSettingModulePrescriptionMaker, Converter={StaticResource BoolToVisibilityConverter}}"
                                             d:Visibility="Visible"
                                             Style="{StaticResource applicationsTabItem}">
                                        <Grid>

                                            <StackPanel Margin="0,0,0,0">
                                                <Grid Margin="10,0">
                                                    <Grid.RowDefinitions>
                                                        <RowDefinition Height="auto" />
                                                        <RowDefinition />
                                                        <RowDefinition />
                                                        <RowDefinition />
                                                        <RowDefinition />
                                                        <RowDefinition />
                                                        <RowDefinition />
                                                    </Grid.RowDefinitions>






                                                    <StackPanel Grid.Row="2"
                                                                Margin="0,0,0,0">
                                                        <TextBlock Text="Prescription Maker"
                                                                   FontSize="26"
                                                                   FontWeight="Thin" />

                                                        <CheckBox Content="Watch for appearing PDF files in folder"
                                                                  Foreground="Beige"
                                                                  VerticalAlignment="Top"
                                                                  HorizontalAlignment="Left"
                                                                  Cursor="Hand"
                                                                  IsChecked="{Binding CbSettingWatchFolderPrescriptionMaker, Mode=TwoWay}"
                                                                  Style="{StaticResource CircleCheckBox}"
                                                                  Command="{Binding CbSettingWatchFolderPrescriptionMakerCommand}"
                                                                  Margin="0,6,5,0" />
                                                        <StackPanel Orientation="Horizontal"
                                                                    Margin="19,5,0,0">
                                                            <TextBlock Text="Watched folder (PDF source):"
                                                                       Margin="0,0,6,0" />
                                                            <TextBlock Text="{Binding PmWatchedPdfFolder}"
                                                                       Foreground="LightGreen"
                                                                       d:Text="C:\ExampleFolder"
                                                                       Cursor="Hand"
                                                                       ToolTip="Click here to browse &amp; setup a new folder">
                                                    <i:Interaction.Triggers>
                                                        <i:EventTrigger EventName="MouseDown">
                                                            <i:InvokeCommandAction Command="{Binding PmSelectTargetFolderCommand}"
                                                                                   CommandParameter="PmWatchedPdfFolder" />
                                                        </i:EventTrigger>
                                                    </i:Interaction.Triggers>
                                                            </TextBlock>

                                                        </StackPanel>
                                                        <StackPanel Orientation="Horizontal"
                                                                    Margin="19,5,0,0">
                                                            <TextBlock Text="Final prescriptions location:"
                                                                       Margin="0,0,6,0" />
                                                            <TextBlock Text="{Binding PmFinalPrescriptionsFolder}"
                                                                       Foreground="LightYellow"
                                                                       d:Text="C:\ExampleFolder"
                                                                       Cursor="Hand"
                                                                       ToolTip="Click here to browse &amp; setup a new folder">
                                                    <i:Interaction.Triggers>
                                                        <i:EventTrigger EventName="MouseDown">
                                                            <i:InvokeCommandAction Command="{Binding PmSelectTargetFolderCommand}"
                                                                                   CommandParameter="FinalPrescriptionsFolder" />
                                                        </i:EventTrigger>
                                                    </i:Interaction.Triggers>
                                                            </TextBlock>

                                                        </StackPanel>

                                                        <CheckBox Content="Open up scan folder after processing Sirona prescription"
                                                                  Foreground="Beige"
                                                                  VerticalAlignment="Top"
                                                                  HorizontalAlignment="Left"
                                                                  Cursor="Hand"
                                                                  IsChecked="{Binding CbSettingOpenUpSironaScanFolder, Mode=TwoWay}"
                                                                  Style="{StaticResource CircleCheckBox}"
                                                                  Command="{Binding CbSettingOpenUpSironaScanFolderCommand}"
                                                                  Margin="0,16,5,0" />
                                                        <StackPanel Orientation="Horizontal"
                                                                    Margin="19,5,0,0">
                                                            <TextBlock Text="Sirona Scans folder:"
                                                                       Margin="0,0,6,0" />
                                                            <TextBlock Text="{Binding PmSironaScansFolder}"
                                                                       Foreground="Linen"
                                                                       d:Text="C:\ExampleFolder"
                                                                       Cursor="Hand"
                                                                       ToolTip="Click here to browse &amp; setup a new folder">
                                                    <i:Interaction.Triggers>
                                                        <i:EventTrigger EventName="MouseDown">
                                                            <i:InvokeCommandAction Command="{Binding PmSelectTargetFolderCommand}"
                                                                                   CommandParameter="SironaScansFolder" />
                                                        </i:EventTrigger>
                                                    </i:Interaction.Triggers>
                                                            </TextBlock>

                                                        </StackPanel>

                                                        <CheckBox Content="Extract downloaded iTero zip files to the iTero Export folder"
                                                                  Foreground="AliceBlue"
                                                                  VerticalAlignment="Top"
                                                                  HorizontalAlignment="Left"
                                                                  Cursor="Hand"
                                                                  IsChecked="{Binding CbSettingExtractIteroZipFiles, Mode=TwoWay}"
                                                                  Style="{StaticResource CircleCheckBox}"
                                                                  Command="{Binding CbSettingExtractIteroZipFilesCommand}"
                                                                  Margin="0,16,5,0" />

                                                        <StackPanel Orientation="Horizontal"
                                                                    Margin="19,5,0,0">
                                                            <TextBlock Text="iTero Export folder:"
                                                                       Margin="0,0,6,0" />
                                                            <TextBlock Text="{Binding PmIteroExportFolder}"
                                                                       Foreground="Bisque"
                                                                       d:Text="C:\ExampleFolder"
                                                                       Cursor="Hand"
                                                                       ToolTip="Click here to browse &amp; setup a new folder">
                                                    <i:Interaction.Triggers>
                                                        <i:EventTrigger EventName="MouseDown">
                                                            <i:InvokeCommandAction Command="{Binding PmSelectTargetFolderCommand}"
                                                                                   CommandParameter="IteroExportFolder" />
                                                        </i:EventTrigger>
                                                    </i:Interaction.Triggers>
                                                            </TextBlock>

                                                        </StackPanel>

                                                        <StackPanel Orientation="Horizontal"
                                                                    Margin="19,5,0,0">
                                                            <TextBlock Text="Download folder:"
                                                                       Margin="0,0,6,0" />
                                                            <TextBlock Text="{Binding PmDownloadFolder}"
                                                                       Foreground="Aquamarine"
                                                                       d:Text="C:\ExampleFolder"
                                                                       Cursor="Hand"
                                                                       ToolTip="Click here to browse &amp; setup a new folder">
                                                    <i:Interaction.Triggers>
                                                        <i:EventTrigger EventName="MouseDown">
                                                            <i:InvokeCommandAction Command="{Binding PmSelectTargetFolderCommand}"
                                                                                   CommandParameter="PmDownloadFolder" />
                                                        </i:EventTrigger>
                                                    </i:Interaction.Triggers>
                                                            </TextBlock>

                                                        </StackPanel>

                                                        <StackPanel Margin="19,15,0,0">
                                                            <TextBlock Text="Sent To List"
                                                                       Margin="0,0,0,7" />
                                                            <StackPanel Orientation="Horizontal">
                                                                <ListBox ItemsSource="{Binding PmSendToList}"
                                                                         Background="#777"
                                                                         BorderBrush="Beige"
                                                                         BorderThickness="1"
                                                                         Foreground="Beige"
                                                                         Width="200"
                                                                         MinHeight="60"
                                                                         MaxHeight="200"
                                                                         SelectedItem="{Binding PmSelectedSendToEntry}"
                                                                         Margin="0,0,6,0" />
                                                                <DockPanel LastChildFill="False">
                                                                    <TextBox Width="100"
                                                                             Background="#777"
                                                                             BorderBrush="Beige"
                                                                             BorderThickness="1"
                                                                             Foreground="Beige"
                                                                             Text="{Binding PmNewSentToName, UpdateSourceTrigger=PropertyChanged}"
                                                                             DockPanel.Dock="Top" />
                                                                    <Button Content="Remove"
                                                                            DockPanel.Dock="Bottom"
                                                                            Command="{Binding PmRemoveFromSentToListCommand}"
                                                                            Visibility="{Binding PmSelectedSendToEntry, Converter={StaticResource EmptyToHiddenConverter}}"
                                                                            d:Visibility="Visible" />
                                                                    <Button Content="Add"
                                                                            DockPanel.Dock="Bottom"
                                                                            Command="{Binding PmAddToSentToListCommand}"
                                                                            Margin="0,0,0,4" />
                                                                </DockPanel>
                                                            </StackPanel>
                                                        </StackPanel>
                                                    </StackPanel>
                                                </Grid>
                                            </StackPanel>
                                        </Grid>
                                    </TabItem>


                                    <TabItem Header="Customer Suggestions"
                                             Style="{StaticResource applicationsTabItem}">
                                        <Grid Margin="5">
                                            <Grid.RowDefinitions>
                                                <RowDefinition Height="40" />
                                                <RowDefinition />
                                                <RowDefinition Height="40" />
                                            </Grid.RowDefinitions>

                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="auto" />
                                                <ColumnDefinition Width="auto" />
                                                <ColumnDefinition />
                                                <ColumnDefinition />
                                            </Grid.ColumnDefinitions>

                                            <TextBlock Text="Customer name"
                                                       VerticalAlignment="Bottom"
                                                       HorizontalAlignment="Left"
                                                       Margin="6,0"
                                                       FontSize="14" />

                                            <TextBlock Text="Replacements"
                                                       VerticalAlignment="Bottom"
                                                       HorizontalAlignment="Left"
                                                       Grid.Column="1"
                                                       Margin="8,0"
                                                       FontSize="14" />

                                            <ListBox Grid.Row="1"
                                                     Margin="0,0,2,0"
                                                     ItemsSource="{Binding CustomerSuggestionsCusNamesList}"
                                                     SelectedItem="{Binding SelectedCustomerName}"
                                                     Foreground="Beige"
                                                     MinWidth="150"
                                                     Background="#444" />

                                            <ListBox Grid.Row="1"
                                                     Grid.Column="1"
                                                     Margin="2,0,4,0"
                                                     ItemsSource="{Binding CustomerSuggestionsReplacementsList}"
                                                     SelectedItem="{Binding SelectedCustomerSuggestion}"
                                                     Foreground="Beige"
                                                     MinWidth="150"
                                                     Background="#444" />

                                            <Button Content="Delete customer"
                                                    Grid.Row="2"
                                                    Margin="0,5,3,5"
                                                    Command="{Binding DeleteCSCustomerCommand}" />

                                            <Button Content="Delete suggestion"
                                                    Grid.Row="2"
                                                    Grid.Column="1"
                                                    Margin="3,5,4,5"
                                                    Command="{Binding DeleteCSSuggestionCommand}" />


                                            <TextBlock Text="Create new suggestion"
                                                       VerticalAlignment="Bottom"
                                                       HorizontalAlignment="Left"
                                                       Grid.Column="2"
                                                       Margin="19,0"
                                                       FontSize="14" />

                                            <StackPanel Grid.Row="1"
                                                        Grid.Column="2"
                                                        Margin="20,10">
                                                <TextBlock Text="Customer" />
                                                <TextBox  Width="200"
                                                          Text="{Binding CSNewCustomer}"
                                                          Background="#555"
                                                          Foreground="Beige"
                                                          HorizontalAlignment="Left" />

                                                <TextBlock Text="Replacement"
                                                           Margin="0,10,0,0" />
                                                <TextBox  Width="200"
                                                          Text="{Binding CSNewReplacement}"
                                                          Background="#555"
                                                          Foreground="Beige"
                                                          HorizontalAlignment="Left" />

                                                <Button Content="Add"
                                                        Width="200"
                                                        Margin="0,10"
                                                        HorizontalAlignment="Left"
                                                        Command="{Binding AddNewCustomerSuggestionCommand}" />
                                            </StackPanel>
                                        </Grid>
                                    </TabItem>

                                </TabControl>
                            </Grid>
                        </TabItem>
                    </TabControl>

                </TabItem>
                <!--#endregion SETTINGS TAB -->
            </TabControl>
            <!-- END OF MAIN AREA -->



            <!--#region Conrtrol panel for Copy-->

            <Border Grid.Row="1"
                    Grid.Column="1"
                    VerticalAlignment="Bottom"
                    HorizontalAlignment="Left"
                    Margin="150,0,0,34"
                    BorderThickness="0.85"
                    BorderBrush="#DDD"
                    Background="#66696F"
                    CornerRadius="10"
                    Panel.ZIndex="460"
                    Visibility="{Binding FsCopyPanelShows, Converter={StaticResource BoolToVisibilityConverter}}"
                    d:Visibility="Hidden">
                <Border.BitmapEffect>
                    <DropShadowBitmapEffect Color="Black"
                                            Direction="270"
                                            ShadowDepth="3"
                                            Opacity="0.55"
                                            Softness="2" />
                </Border.BitmapEffect>
                <Grid Grid.Row="1"
                      MinWidth="300"
                      MaxWidth="700"
                      MaxHeight="420"
                      Height="80"
                      Panel.ZIndex="400"
                      Margin="10,5"
                      VerticalAlignment="Bottom"
                      HorizontalAlignment="Left">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="150" />
                        <ColumnDefinition Width="25" />
                        <ColumnDefinition />
                        <ColumnDefinition />
                    </Grid.ColumnDefinitions>
                    <Grid.RowDefinitions>
                        <RowDefinition />
                        <RowDefinition />
                    </Grid.RowDefinitions>

                    <TextBlock Text="╳"
                               Grid.Column="3"
                               Cursor="Hand"
                               FontSize="10"
                               HorizontalAlignment="Right"
                               Margin="-20,3,4,0">
             <i:Interaction.Triggers>
                 <i:EventTrigger EventName="MouseDown">
                     <i:InvokeCommandAction Command="{Binding FsHideNotificationCommand}" />
                 </i:EventTrigger>
             </i:Interaction.Triggers>
                    </TextBlock>

                    <StackPanel Orientation="Horizontal"
                                Grid.Column="0"
                                Grid.ColumnSpan="3">
                        <TextBlock Text="Selected:"
                                   Margin="0,3,0,0" />
                        <Image Source="/Images/folder.png"
                               Width="20"
                               Height="20"
                               Margin="0,1,0,0"
                               VerticalAlignment="Top" />
                        <TextBlock Text="{Binding FsSelectedFolderObject.FolderName}"
                                   d:Text="Example Folder "
                                   Foreground="BlanchedAlmond"
                                   TextTrimming="CharacterEllipsis"
                                   FontWeight="SemiBold"
                                   FontSize="16"
                                   Cursor="Hand"
                                   ToolTip="Click here to open up folder"
                                   Margin="2,0,20,0">
                 <i:Interaction.Triggers>
                     <i:EventTrigger EventName="MouseDown">
                         <i:InvokeCommandAction Command="{Binding FsOpenFolderCommand}"
                                                CommandParameter="{Binding FsSelectedFolderObject.Path}" />
                     </i:EventTrigger>
                 </i:Interaction.Triggers>
                        </TextBlock>
                    </StackPanel>

                    <TextBlock Text="Copy over with number:"
                               Grid.Row="0"
                               Grid.Column="0"
                               Visibility="{Binding SelectedPendingDigiNumber, Converter={StaticResource EmptyToHiddenConverter}}"
                               d:Visibility="Visible"
                               VerticalAlignment="Bottom" />
                    <Button FontSize="25"
                            Grid.Row="1"
                            Grid.Column="0"
                            Visibility="{Binding SelectedPendingDigiNumber, Converter={StaticResource EmptyToHiddenConverter}}"
                            d:Visibility="Visible"
                            Command="{Binding FsCopyFolderOverCommand}"
                            CommandParameter="{Binding SelectedPendingDigiNumber}"
                            Margin="0,4">
                        <StackPanel Orientation="Horizontal"
                                    Margin="-20,0,0,0">
                            <Image Source="\Images\ToolBar\stcopy.png"
                                   Width="30"
                                   Height="20" />
                            <TextBlock Text="{Binding SelectedPendingDigiNumber}"
                                       d:Text="125"
                                       Margin="0,-3,0,0" />
                        </StackPanel>
                    </Button>

                    <TextBlock Text="or"
                               Grid.Row="1"
                               Grid.Column="1"
                               Visibility="{Binding SelectedPendingDigiNumber, Converter={StaticResource EmptyToHiddenConverter}}"
                               d:Visibility="Visible"
                               VerticalAlignment="Center"
                               HorizontalAlignment="Right" />


                    <TextBlock Text="Giva a number:"
                               Grid.Row="0"
                               Grid.Column="2"
                               Margin="12,0,0,0"
                               VerticalAlignment="Bottom" />
                    <StackPanel Orientation="Horizontal"
                                HorizontalAlignment="Left"
                                Margin="14,0,0,0"
                                Grid.Row="1"
                                Grid.Column="2">
                        <TextBox Width="80"
                                 FontSize="25"
                                 Text="{Binding FsCustomNumber, Mode=TwoWay}"
                                 d:Text="4004"
                                 HorizontalContentAlignment="Center"
                                 Height="32"
                                 Margin="0,0,0,0" />


                        <Button Margin="4,4,0,4"
                                Command="{Binding FsCopyFolderOverCommand}"
                                CommandParameter="{Binding FsCustomNumber}"
                                Width="40">
                            <StackPanel Orientation="Horizontal"
                                        Margin="0,0,0,0">
                                <Image Source="\Images\ToolBar\stcopy.png"
                                       Width="20"
                                       Height="20" />
                            </StackPanel>
                        </Button>
                    </StackPanel>
                </Grid>

            </Border>
            <!--#endregion Conrtrol panel for Copy-->


            <!-- NOTIFICATION MESSAGE -->
            <Border Grid.Row="{Binding NotificationMessageGridPosition}"
                    d:Grid.Row="1"
                    Grid.Column="1"
                    x:Name="notificationMessagePanel"
                    d:Visibility="Visible"
                    Visibility="{Binding NotificationMessageVisibility}"
                    Panel.ZIndex="150"
                    VerticalAlignment="{Binding NotificationMessageVertAlignment}"
                    d:VerticalAlignment="Bottom"
                    HorizontalAlignment="Left"
                    Margin="{Binding NotificationMessagePosition}"
                    BorderThickness="0.85"
                    BorderBrush="#DDD"
                    Background="#66696F"
                    CornerRadius="10"
                    Opacity="0"
                    d:Opacity="1">
                <Border.BitmapEffect>
                    <DropShadowBitmapEffect Color="Black"
                                            Direction="270"
                                            ShadowDepth="3"
                                            Opacity="0.55"
                                            Softness="2" />
                </Border.BitmapEffect>
                <Grid Grid.Row="1"
                      MaxWidth="300"
                      MaxHeight="420"
                      MinWidth="180"
                      Panel.ZIndex="400"
                      VerticalAlignment="Bottom"
                      HorizontalAlignment="Left">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="auto" />
                        <RowDefinition Height="auto" />
                    </Grid.RowDefinitions>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="40" />
                        <ColumnDefinition Width="1*" />
                    </Grid.ColumnDefinitions>
                    <Border Grid.RowSpan="2"
                            Background="#56595F"
                            CornerRadius="10,0,0,10">
                        <Image Source="{Binding NotificationMessageIcon}"
                               d:Source="\Images\MessageIcons\Info.png"
                               Width="40"
                               Height="40"
                               Grid.RowSpan="2"
                               VerticalAlignment="Top" />

                    </Border>
                    <Border Grid.Column="1"
                            ClipToBounds="True"
                            CornerRadius="0,10,0,5">

                        <TextBlock Text="{Binding NotificationMessageTitle}"
                                   d:Text="Notification Title"
                                   Padding="6,3,6,3"
                                   FontSize="9"
                                   FontWeight="SemiBold">
                        <i:Interaction.Triggers>
                            <i:EventTrigger EventName="MouseDown">
                                <i:InvokeCommandAction Command="{Binding HideNotificationCommand}" />
                            </i:EventTrigger>
                        </i:Interaction.Triggers>
                        </TextBlock>
                    </Border>

                    <TextBlock Text="{Binding NotificationMessageBody}"
                               d:Text="Notification message body Notification message body Notification message body"
                               TextWrapping="Wrap"
                               Padding="6,3,8,8"
                               Foreground="White"
                               FontSize="11"
                               Grid.Row="1"
                               Grid.Column="2">
                        <i:Interaction.Triggers>
                            <i:EventTrigger EventName="MouseDown">
                                <i:InvokeCommandAction Command="{Binding HideNotificationCommand}" />
                            </i:EventTrigger>
                        </i:Interaction.Triggers>
                    </TextBlock>
                    <TextBlock Text="╳"
                               Grid.Column="1"
                               Cursor="Hand"
                               FontSize="10"
                               HorizontalAlignment="Right"
                               Margin="0,2,8,0">
                        <i:Interaction.Triggers>
                            <i:EventTrigger EventName="MouseDown">
                                <i:InvokeCommandAction Command="{Binding HideNotificationCommand}" />
                            </i:EventTrigger>
                        </i:Interaction.Triggers>
                    </TextBlock>
                </Grid>
            </Border>
            <!-- END OF NOTIFICATION MESSAGE -->


            <!-- FOOTER -->
            <Grid Grid.Row="2"
                  Grid.Column="1"
                  Margin="0,0,0,1">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition />
                    <ColumnDefinition Width="auto" />
                </Grid.ColumnDefinitions>

                <!--ProgressBar IsIndeterminate="True"
                             Grid.ColumnSpan="2"
                             Margin="0,-1,0,0"
                             Panel.ZIndex="-10"
                             Height="4"
                             VerticalAlignment="Top"
                             Opacity="0.95"
                             BorderBrush="#55595F"
                             Background="#55595F"
                             Foreground="#ede505"
                             Visibility="{Binding ServerIsWritingDatabase, Converter={StaticResource BoolToVisibilityConverter}}" /-->

                <StackPanel Visibility="{Binding ShowBottomInfoBar, Converter={StaticResource BoolToVisibilityConverter}}"
                            d:Visibility="Visible">

                    <StackPanel Orientation="Horizontal"
                                HorizontalAlignment="Left"
                                VerticalAlignment="Top"
                                Margin="2,2,5,0">
                        <core:OutlinedTextBlock Stroke="#222"
                                                StrokePosition="Outside"
                                                FontSize="20"
                                                FontWeight="SemiBold"
                                                Fill="LightYellow"
                                                StrokeThickness="0.5"
                                                Margin="0,2,8,0"
                                                Text="Server is" />

                        <Grid>
                            <core:OutlinedTextBlock Stroke="#333"
                                                    StrokePosition="Outside"
                                                    FontSize="20"
                                                    FontWeight="SemiBold"
                                                    Fill="NavajoWhite"
                                                    StrokeThickness="0.5"
                                                    Margin="-2,2,0,0"
                                                    Text="{Binding ServerStatus}" />
                        </Grid>

                    </StackPanel>

                    <StackPanel Orientation="Horizontal"
                                HorizontalAlignment="Left"
                                VerticalAlignment="Top"
                                Margin="2,2,5,0"
                                Visibility="{Binding ThreeShapeServerIsDown, Converter={StaticResource BoolToVisibilityConverter}}"
                                d:Visibility="Visible">
                        <core:OutlinedTextBlock Stroke="#222"
                                                StrokePosition="Outside"
                                                FontSize="15"
                                                FontWeight="SemiBold"
                                                Fill="#ffabb6"
                                                StrokeThickness="0.5"
                                                Margin="0,0,8,0"
                                                Text="Lost connection to 3Shape Server" />

                    </StackPanel>

                    <Grid Visibility="{Binding IsDCASIsActive, Converter={StaticResource BoolToVisibilityConverter}}"
                          d:Visibility="Visible">
                        <DockPanel HorizontalAlignment="Left"
                                   VerticalAlignment="Top"
                                   Margin="2,0,5,0"
                                   MaxWidth="265"
                                   MinWidth="245"
                                   Visibility="{Binding LastDCASUpdate, Converter={StaticResource EmptyToCollapsedConverter}}"
                                   d:Visibility="Visible">
                            <core:OutlinedTextBlock Stroke="#222"
                                                    StrokePosition="Outside"
                                                    FontSize="15"
                                                    FontWeight="SemiBold"
                                                    Fill="LightYellow"
                                                    StrokeThickness="0.5"
                                                    Margin="0,0,8,0"
                                                    Text="Last D.C.A.S. update" />
                            <core:OutlinedTextBlock Stroke="#222"
                                                    StrokePosition="Outside"
                                                    HorizontalAlignment="Right"
                                                    FontSize="15"
                                                    FontWeight="SemiBold"
                                                    Fill="NavajoWhite"
                                                    StrokeThickness="0.5"
                                                    Margin="0,0,0,0"
                                                    d:Text="38 seconds ago"
                                                    Text="{Binding LastDCASUpdate}" />
                            <i:Interaction.Triggers>
                                <i:EventTrigger EventName="MouseDown">
                                    <i:InvokeCommandAction Command="{Binding RequestDCASUpdateCommand}" />
                                </i:EventTrigger>
                            </i:Interaction.Triggers>
                        </DockPanel>
                    </Grid>

                    <StackPanel Orientation="Horizontal"
                                Margin="3,4,0,0"
                                VerticalAlignment="Bottom">

                        <TextBlock Text="List updatable"
                                   Foreground="#AAA"
                                   FontSize="8" />
                        <TextBlock Text="{Binding ListUpdateable}"
                                   Foreground="#CCC"
                                   FontSize="8"
                                   Margin="3,0,0,0" />
                    </StackPanel>
                </StackPanel>


                <DockPanel VerticalAlignment="Bottom"
                           HorizontalAlignment="Left"
                           MinWidth="220">

                    <StackPanel VerticalAlignment="Bottom"
                                HorizontalAlignment="Center"
                                Margin="-5,0,15,0">
                        <TextBox Width="60"
                                 Height="20"
                                 d:Text="8000"
                                 IsTabStop="False"
                                 Background="{Binding PcPanColor}"
                                 Foreground="Beige"
                                 d:Background="#53575F"
                                 BorderBrush="#66697F"
                                 HorizontalContentAlignment="Center"
                                 HorizontalAlignment="Center"
                                 FontSize="15"
                                 FontWeight="SemiBold"
                                 Text="{Binding PcPanNumber, UpdateSourceTrigger=PropertyChanged}">
                            <TextBox.InputBindings>
                                <KeyBinding Key="Enter"
                                            Command="{Binding PcCheckPanColorCommand}" />
                            </TextBox.InputBindings>
                            <TextBox.ContextMenu>
                                <ContextMenu>
                                    <MenuItem Header="{Binding OpenUpColorCheckWindowMenuItemTitle}"
                                              d:Header="Open up ColorCheck window"
                                              Click="MenuItemOpenUpColorCheckWindow_Click" />
                                </ContextMenu>
                            </TextBox.ContextMenu>
                        </TextBox>
                        <TextBlock Text="{Binding PcPanColorFriendlyName}"
                                   d:Text="Check pan color"
                                   Width="70"
                                   Foreground="White"
                                   TextAlignment="Center"
                                   FontSize="8" />
                    </StackPanel>


                    <StackPanel VerticalAlignment="Bottom"
                                HorizontalAlignment="Left"
                                Margin="5,0,15,0"
                                Visibility="{Binding PmLastTakenPanNumber, Converter={StaticResource EmptyToCollapsedConverter}}"
                                d:Visibility="Visible">
                        <TextBlock Text="{Binding PmLastTakenPanNumber}"
                                   d:Text="8008"
                                   Foreground="Yellow"
                                   HorizontalAlignment="Center"
                                   Margin="0,0,0,-6"
                                   FontSize="26">
                                <i:Interaction.Triggers>
                                    <i:EventTrigger EventName="MouseDown">
                                        <i:InvokeCommandAction Command="{Binding SwitchToPrescriptionMakerTabCommand}" />
                                    </i:EventTrigger>
                                </i:Interaction.Triggers>
                        </TextBlock>
                        <TextBlock Text="Last grabbed number"
                                   Foreground="White"
                                   FontSize="8" />
                    </StackPanel>


                    <StackPanel Visibility="{Binding CbSettingModuleFolderSubscription, Converter={StaticResource BoolToVisibilityConverter}}"
                                d:Visibility="Visible"
                                VerticalAlignment="Bottom"
                                HorizontalAlignment="Left">

                        <StackPanel Visibility="{Binding CbSettingShowPendingDigiCases, Converter={StaticResource BoolToVisibilityConverter}}"
                                    d:Visibility="Visible">
                            <TextBlock Text="{Binding PendingDigiNumbersWaitingToCollectInt}"
                                       d:Text="9"
                                       Foreground="#8ce4ff"
                                       HorizontalAlignment="Center"
                                       Margin="5,0,15,-6"
                                       FontSize="26"
                                       Cursor="Hand"
                                       Visibility="{Binding PendingDigiNumbersWaitingToCollectInt, Converter={StaticResource ZeroToCollapsedConverter}}"
                                       d:Visibility="Visible">
                            <i:Interaction.Triggers>
                                <i:EventTrigger EventName="MouseDown">
                                    <i:InvokeCommandAction Command="{Binding SwitchToFolderSubscriptionTabCommand}" />
                                </i:EventTrigger>
                            </i:Interaction.Triggers>
                            </TextBlock>
                            <TextBlock Text="Pending digi for collect"
                                       Foreground="White"
                                       FontSize="8"
                                       Margin="5,0,15,0"
                                       Visibility="{Binding PendingDigiNumbersWaitingToCollectInt, Converter={StaticResource ZeroToCollapsedConverter}}"
                                       d:Visibility="Visible" />
                        </StackPanel>
                    </StackPanel>

                    <StackPanel Visibility="{Binding CbSettingModulePrescriptionMaker, Converter={StaticResource BoolToVisibilityConverter}}"
                                d:Visibility="Visible"
                                VerticalAlignment="Bottom"
                                HorizontalAlignment="Left"
                                Margin="5,0,15,0">

                        <StackPanel Visibility="{Binding CbSettingShowEmptyPanCount, Converter={StaticResource BoolToVisibilityConverter}}"
                                    d:Visibility="Visible">
                            <TextBlock Text="{Binding PmPanNumberList.Count, UpdateSourceTrigger=PropertyChanged}"
                                       d:Text="13"
                                       Foreground="#85ffce"
                                       HorizontalAlignment="Center"
                                       Margin="0,0,0,-6"
                                       Cursor="Hand"
                                       FontSize="26">
                                <i:Interaction.Triggers>
                                    <i:EventTrigger EventName="MouseDown">
                                        <i:InvokeCommandAction Command="{Binding SwitchToPrescriptionMakerTabCommand}" />
                                    </i:EventTrigger>
                                </i:Interaction.Triggers>
                            </TextBlock>
                            <TextBlock Text="Empty pan left"
                                       Foreground="White"
                                       FontSize="8" />
                        </StackPanel>
                    </StackPanel>

                    <StackPanel Visibility="{Binding CbSettingShowDigiPrescriptionsCount, Converter={StaticResource BoolToVisibilityConverter}}"
                                d:Visibility="Visible"
                                VerticalAlignment="Bottom"
                                HorizontalAlignment="Left">
                        <TextBlock Text="{Binding DigiPrescriptionsTodayCount}"
                                   d:Text="13"
                                   Foreground="#fad282"
                                   HorizontalAlignment="Center"
                                   Margin="5,0,15,-6"
                                   Visibility="{Binding DigiPrescriptionsTodayCount, Converter={StaticResource ZeroToCollapsedConverter}}"
                                   d:Visibility="Visible"
                                   FontSize="26" />
                        <TextBlock Text="Digi Prescriptions"
                                   Foreground="White"
                                   Visibility="{Binding DigiPrescriptionsTodayCount, Converter={StaticResource ZeroToCollapsedConverter}}"
                                   d:Visibility="Visible"
                                   FontSize="8"
                                   Margin="5,0,15,0" />
                    </StackPanel>

                    <StackPanel Visibility="{Binding CbSettingShowDigiCasesIn3ShapeTodayCount, Converter={StaticResource BoolToVisibilityConverter}}"
                                d:Visibility="Visible"
                                VerticalAlignment="Bottom"
                                HorizontalAlignment="Left">
                        <TextBlock Text="{Binding DigiCasesIn3ShapeTodayCount}"
                                   d:Text="13"
                                   Foreground="#f8fa82"
                                   HorizontalAlignment="Center"
                                   Visibility="{Binding DigiCasesIn3ShapeTodayCount, Converter={StaticResource ZeroToCollapsedConverter}}"
                                   d:Visibility="Visible"
                                   Margin="5,0,15,-6"
                                   FontSize="26" />
                        <TextBlock Text="Digi cases Today"
                                   Foreground="White"
                                   FontSize="8"
                                   Visibility="{Binding DigiCasesIn3ShapeTodayCount, Converter={StaticResource ZeroToCollapsedConverter}}"
                                   d:Visibility="Visible"
                                   Margin="5,0,15,0" />
                    </StackPanel>

                    <StackPanel Visibility="{Binding DebugMessages.Count, Converter={StaticResource ZeroToCollapsedConverter}}"
                                d:Visibility="Visible"
                                x:Name="debugMessagesCounter"
                                VerticalAlignment="Bottom"
                                HorizontalAlignment="Left">
                        <TextBlock Text="{Binding DebugMessages.Count}"
                                   d:Text="87"
                                   x:Name="debugMessageCount"
                                   Foreground="#fd7aC2"
                                   HorizontalAlignment="Center"
                                   Visibility="{Binding CbSettingModuleDebug, Converter={StaticResource BoolToVisibilityConverter}}"
                                   d:Visibility="Visible"
                                   Margin="5,0,15,-6"
                                   Cursor="Hand"
                                   FontSize="26">
                            <i:Interaction.Triggers>
                                <i:EventTrigger EventName="MouseDown">
                                    <i:InvokeCommandAction Command="{Binding SwitchToDebugMessagesTabCommand}" />
                                </i:EventTrigger>
                            </i:Interaction.Triggers>
                        </TextBlock>
                        <TextBlock Text="Debug Messages"
                                   Foreground="White"
                                   FontSize="8"
                                   Visibility="{Binding CbSettingModuleDebug, Converter={StaticResource BoolToVisibilityConverter}}"
                                   d:Visibility="Visible"
                                   Margin="5,0,15,0" />
                    </StackPanel>
                </DockPanel>





                <StackPanel Grid.Column="1"
                            Visibility="{Binding NewDigiCaseArrivedCount, Converter={StaticResource ZeroToCollapsedConverter}}"
                            d:Visibility="Visible">
                    <Grid>
                        <core:OutlinedTextBlock Stroke="#333"
                                                StrokePosition="Outside"
                                                FontSize="20"
                                                FontWeight="SemiBold"
                                                Fill="LightYellow"
                                                StrokeThickness="0.5"
                                                Visibility="{Binding CbSettingShowDigiCases, Converter={StaticResource BoolToVisibilityConverter}}"
                                                d:Visibility="Visible"
                                                Margin="0,2,8,0"
                                                Cursor="Hand"
                                                Text="{Binding NewDigiCaseArrivedCount, StringFormat='\{0} new digital case arrived'}">
                            <i:Interaction.Triggers>
                                <i:EventTrigger EventName="MouseDown">
                                    <i:InvokeCommandAction Command="{Binding SwitchToPendingDigiCasesTabCommand}" />
                                </i:EventTrigger>
                            </i:Interaction.Triggers>
                        </core:OutlinedTextBlock>
                    </Grid>

                    <DockPanel HorizontalAlignment="Left"
                               VerticalAlignment="Top">

                        <ScrollViewer VerticalAlignment="Top"
                                      DockPanel.Dock="Left"
                                      VerticalScrollBarVisibility="Visible"
                                      HorizontalScrollBarVisibility="Disabled"
                                      CanContentScroll="True"
                                      ClipToBounds="True"
                                      Visibility="{Binding CbSettingShowDigiDetails, Converter={StaticResource BoolToVisibilityConverter}}"
                                      d:Visibility="Visible"
                                      Margin="1,1,10,1">

                            <StackPanel x:Name="panelDigiCases"
                                        Margin="0,0,3,0"
                                        VerticalAlignment="Top">
                                <TextBlock FontSize="10"
                                           FontWeight="SemiBold"
                                           Text="Medit ⇢ Got 7 new case (Example Lab)" />
                            </StackPanel>
                        </ScrollViewer>
                    </DockPanel>
                </StackPanel>
            </Grid>
            <!-- END OF FOOTER -->
        </Grid>
    </Border>
</Window>
